<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-28T11:33:50.6367994"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>Rename Refactoring | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"name-validation","level":0,"title":"Name Validation","anchor":"#name-validation"},{"id":"custom-rename-ui-and-workflow","level":0,"title":"Custom Rename UI and Workflow","anchor":"#custom-rename-ui-and-workflow"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Rename Refactoring | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/rename-refactoring.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="Rename Refactoring | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/rename-refactoring.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/rename-refactoring.html", "name": "Rename Refactoring | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="rename_refactoring.md" data-main-title="Rename Refactoring" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part VII — Custom Languages///custom_language_support.md|Custom Language Support"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/reference_guide/custom_language_support/rename_refactoring.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="rename_refactoring.md" id="rename_refactoring.md"  >Rename Refactoring</h1><p id="b91cc6ed_1" >The Rename refactoring operation is quite similar to that of <a href="find-usages.html" id="b91cc6ed_2" data-tooltip="The Find Usages action is a multi-step process, and each step of the process requires involvement from the custom language plugin."  >Find Usages</a>. It uses the same rules for locating the element to be renamed and the same index of words for finding the files that may have references to the element being renamed.</p><p id="b91cc6ed_3" >When the rename refactoring is performed, the method <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiNamedElement.java" id="b91cc6ed_4"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_5"  >PsiNamedElement.setName()</code></a> is called for the renamed element, and <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiReference.java" id="b91cc6ed_6"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_7"  >PsiReference.handleElementRename()</code></a> is called for all references to the renamed element. These methods perform basically the same action: replace the underlying AST node of the PSI element with the node containing the new text entered by the user. Creating an entirely correct AST node from scratch is quite tricky. Thus, surprisingly, the easiest way to get the replacement node is to create a dummy file in the custom language so that it would contain the necessary node in its parse tree, build the parse tree and extract the required node from it.</p><p id="b91cc6ed_8" ><span class="control" id="b91cc6ed_9" >Examples:</span></p><ul class="list _ul" id="b91cc6ed_10"    ><li class="list__item" id="b91cc6ed_11" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties/properties-psi-impl/src/com/intellij/lang/properties/psi/impl/PropertyImpl.java" id="b91cc6ed_12"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_13"  >setName()</code></a> implementation for a <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties" id="b91cc6ed_14"   data-external="true" rel="noopener noreferrer" >Properties language plugin</a></p></li><li class="list__item" id="b91cc6ed_15" ><p><a href="reference-contributor.html" id="b91cc6ed_16" data-tooltip="Reference: ,"  >Custom Language Support Tutorial: Reference Contributor</a></p></li></ul><p id="b91cc6ed_17" >If a renamed reference extends <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiReferenceBase.java" id="b91cc6ed_18"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_19"  >PsiReferenceBase</code></a>, renaming is performed by invoking the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/ElementManipulator.java" id="b91cc6ed_20"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_21"  >ElementManipulator.handleContentChange()</code></a>, responsible for handling the content change and calculating the text range of reference inside the element.</p><p id="b91cc6ed_22" >To disable renaming for specific elements, implement <code class="code " id="b91cc6ed_23"  >com.intellij.openapi.util.Condition&lt;T&gt;</code> for PsiElement of type <code class="code " id="b91cc6ed_24"  >T</code> and register it in <code class="code " id="b91cc6ed_25"  >com.intellij.vetoRenameCondition</code> extension point.</p><section class="chapter"  ><h2 id="name-validation" data-toc="name-validation"  >Name Validation</h2><p id="b91cc6ed_26" ><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/lang/refactoring/NamesValidator.java" id="b91cc6ed_27"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_28"  >NamesValidator</code></a> allows a plugin to check if the name entered by the user in the <code class="code " id="b91cc6ed_29"  >Rename</code> dialog is a valid identifier (and not a keyword) according to the custom language rules. If an implementation of this interface is not provided by the plugin, Java rules for validating identifiers are used. Implementations of <code class="code " id="b91cc6ed_30"  >NamesValidator</code> are registered in the <code class="code " id="b91cc6ed_31"  >com.intellij.lang.namesValidator</code> extension point.</p><p id="b91cc6ed_32" ><span class="control" id="b91cc6ed_33" >Example</span>: <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties/src/com/intellij/lang/properties/PropertiesNamesValidator.java" id="b91cc6ed_34"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_35"  >PropertiesNamesValidator</code></a> for <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties" id="b91cc6ed_36"   data-external="true" rel="noopener noreferrer" >Properties language plugin</a></p><p id="b91cc6ed_37" >Another way to check is <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/refactoring/src/com/intellij/refactoring/rename/RenameInputValidator.java" id="b91cc6ed_38"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_39"  >RenameInputValidator</code></a>, unlike <code class="code " id="b91cc6ed_40"  >NamesValidator</code> it allows you to more flexibly check the entered name for correctness based on the rule defined in the <code class="code " id="b91cc6ed_41"  >isInputValid()</code> method.</p><p id="b91cc6ed_42" >To determine which elements this validator will apply to, override the <code class="code " id="b91cc6ed_43"  >getPattern()</code> method returning the pattern of the element to validate.</p><p id="b91cc6ed_44" ><span class="control" id="b91cc6ed_45" >Example</span>: <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/yaml/src/org/jetbrains/yaml/resolve/YAMLAnchorRenameInputValidator.java" id="b91cc6ed_46"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_47"  >YAMLAnchorRenameInputValidator</code></a> validating YAML language anchor names</p><p id="b91cc6ed_48" ><code class="code " id="b91cc6ed_49"  >RenameInputValidator</code> can be extended to <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/refactoring/src/com/intellij/refactoring/rename/RenameInputValidatorEx.java" id="b91cc6ed_50"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_51"  >RenameInputValidatorEx</code></a> to override the default error message. The <code class="code " id="b91cc6ed_52"  >getErrorMessage()</code> method should return a custom error message in case of an invalid name, or <code class="code " id="b91cc6ed_53"  >null</code> otherwise.</p><p id="b91cc6ed_54" >Note that <code class="code " id="b91cc6ed_55"  >getErrorMessage()</code> only works if all <code class="code " id="b91cc6ed_56"  >RenameInputValidator</code> accept the new name in <code class="code " id="b91cc6ed_57"  >isInputValid()</code> and the name is a valid identifier for the language of the element.</p><p id="b91cc6ed_58" ><span class="control" id="b91cc6ed_59" >Example</span>: <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/yaml/src/org/jetbrains/yaml/refactoring/rename/YamlKeyValueRenameInputValidator.java" id="b91cc6ed_60"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_61"  >YamlKeyValueRenameInputValidator</code></a> validating YAML language keys</p><p id="b91cc6ed_62" >Implementations of <code class="code " id="b91cc6ed_63"  >RenameInputValidator</code> or <code class="code " id="b91cc6ed_64"  >RenameInputValidatorEx</code> are registered in the <code class="code " id="b91cc6ed_65"  >com.intellij.renameInputValidator</code> extension point.</p></section><section class="chapter"  ><h2 id="custom-rename-ui-and-workflow" data-toc="custom-rename-ui-and-workflow"  >Custom Rename UI and Workflow</h2><p id="b91cc6ed_66" >Further customization of the Rename refactoring processing is possible on multiple levels. Providing a custom implementation of the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/refactoring/src/com/intellij/refactoring/rename/RenameHandler.java" id="b91cc6ed_67"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_68"  >RenameHandler</code></a> interface allows you to entirely replace the UI and workflow of the rename refactoring, and also to support renaming something which is not a <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiElement.java" id="b91cc6ed_69"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_70"  >PsiElement</code></a> at all.</p><p id="b91cc6ed_71" ><span class="control" id="b91cc6ed_72" >Example</span>: <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties/properties-resource-bundle-editor/src/com/intellij/lang/properties/refactoring/rename/ResourceBundleFromEditorRenameHandler.java" id="b91cc6ed_73"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_74"  >RenameHandler</code></a> for renaming a resource bundle in the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties" id="b91cc6ed_75"   data-external="true" rel="noopener noreferrer" >Properties language plugin</a></p><p id="b91cc6ed_76" >If you're okay with the standard UI but need to extend the default logic of renaming, you can provide an implementation of the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/refactoring/rename/RenamePsiElementProcessor.java" id="b91cc6ed_77"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_78"  >RenamePsiElementProcessor</code></a> interface. This allows you to:</p><ul class="list _ul" id="b91cc6ed_79"    ><li class="list__item" id="b91cc6ed_80" ><p>Rename an element different from the one on which the action was invoked (a super method, for example)</p></li><li class="list__item" id="b91cc6ed_81" ><p>Rename multiple elements at once (if their names are linked according to the logic of your language)</p></li><li class="list__item" id="b91cc6ed_82" ><p>Check for name conflicts (existing names, etc.)</p></li><li class="list__item" id="b91cc6ed_83" ><p>Customize how a search for code references or text references is performed</p></li><li class="list__item" id="b91cc6ed_84" ><p>etc.</p></li></ul><p id="b91cc6ed_85" ><span class="control" id="b91cc6ed_86" >Example</span>: <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties/src/com/intellij/lang/properties/refactoring/rename/RenamePropertyProcessor.java" id="b91cc6ed_87"   data-external="true" rel="noopener noreferrer" ><code class="code " id="b91cc6ed_88"  >RenamePsiElementProcessor</code></a> for renaming a property in <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties" id="b91cc6ed_89"   data-external="true" rel="noopener noreferrer" >Properties plugin language</a></p></section><div class="last-modified"> Last modified: 28 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="find-usages.html">Find Usages</a>   <a class="navigation-links__next" href="safe-delete-refactoring.html">Safe Delete Refactoring</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>