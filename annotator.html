<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-28T11:33:50.5928563"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>7. Annotator | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"required-project-configuration-changes","level":0,"title":"Required Project Configuration Changes","anchor":"#required-project-configuration-changes"},{"id":"define-an-annotator","level":0,"title":"Define an Annotator","anchor":"#define-an-annotator"},{"id":"register-the-annotator","level":0,"title":"Register the Annotator","anchor":"#register-the-annotator"},{"id":"run-the-project","level":0,"title":"Run the Project","anchor":"#run-the-project"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="7. Annotator | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/annotator.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="7. Annotator | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/annotator.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/annotator.html", "name": "7. Annotator | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="annotator.md" data-main-title="7. Annotator" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part VII — Custom Languages///custom_language_support_tutorial.md|Custom Language Support Tutorial"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/tutorials/custom_language_support/annotator.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="annotator.md" id="annotator.md"  >7. Annotator</h1><p id="94564f3c_13" >An <code class="code " id="94564f3c_14"  >Annotator</code> helps highlight and annotate any code based on specific rules. This section adds annotation functionality to support the Simple Language in the context of Java code.</p><section class="chapter"  ><h2 id="required-project-configuration-changes" data-toc="required-project-configuration-changes"  >Required Project Configuration Changes</h2><p id="94564f3c_15" >Classes defined in this step of the tutorial depend on <code class="code " id="94564f3c_16"  >com.intellij.psi.PsiLiteralExpression</code> (the PSI representation for String literals in Java code) at runtime. Using <code class="code " id="94564f3c_17"  >PsiLiteralExpression</code> <a href="plugin-compatibility.html#modules-specific-to-functionality" id="94564f3c_18" data-tooltip="More specialized functionality is also delivered via modules and plugins in IntelliJ Platform-based products. For example, the com.intellij.modules.python module supports the Python language-specific functionality. If a plugin uses this module's functionality, such as…"  >introduces a dependency</a> on <code class="code " id="94564f3c_19"  >com.intellij.java</code>.</p><p id="94564f3c_20" >Beginning in version 2019.2, a dependency on Java plugin <a href="https://blog.jetbrains.com/platform/2019/06/java-functionality-extracted-as-a-plugin/" id="94564f3c_21"   data-external="true" rel="noopener noreferrer" >must be declared explicitly</a>. First, add a dependency on the Java plugin in the Gradle build script:</p><div class="tabs" id="94564f3c_22"><div class="tabs__content" data-gtm="tab" id="94564f3c_23"   data-title="Kotlin" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"     >
intellij {
  plugins.set(listOf(&quot;com.intellij.java&quot;))
}
</div></div><div class="tabs__content" data-gtm="tab" id="94564f3c_25"   data-title="Groovy" ><div class="code-block" data-lang="groovy"    data-title="Groovy"     >
intellij {
  plugins = ['com.intellij.java']
}
</div></div></div><p id="94564f3c_27" >Then, declare the dependency in <span class="filepath" id="94564f3c_28" ><a href="plugin-configuration-file.html" id="94564f3c_29" data-tooltip="Plugin configuration file contains all the information about the plugin, as well as all registered extensions, actions, listeners, etc."  >plugin.xml</a></span> (use code insight)</p><div class="code-block" data-lang="markup"         >
&lt;depends&gt;com.intellij.java&lt;/depends&gt;
</div></section><section class="chapter"  ><h2 id="define-an-annotator" data-toc="define-an-annotator"  >Define an Annotator</h2><p id="94564f3c_31" >The <a href="https://github.com/JetBrains/intellij-sdk-code-samples/tree/main/simple_language_plugin/src/main/java/org/intellij/sdk/language/SimpleAnnotator.java" id="94564f3c_32"   data-external="true" rel="noopener noreferrer" ><code class="code " id="94564f3c_33"  >SimpleAnnotator</code></a> subclasses <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/lang/annotation/Annotator.java" id="94564f3c_34"   data-external="true" rel="noopener noreferrer" ><code class="code " id="94564f3c_35"  >Annotator</code></a>. Consider a literal string that starts with &quot;simple:&quot; as a prefix of a Simple Language key. It isn't part of the Simple Language, but it is a useful convention for detecting Simple Language keys embedded as string literals in other languages, like Java. Annotate the <code class="code " id="94564f3c_36"  >simple:key</code> literal expression, and differentiate between a well-formed vs. an unresolved property.</p><aside data-type="tip" class="prompt" data-title="" id="94564f3c_37" ><p id="94564f3c_38" >The use of new <code class="code " id="94564f3c_39"  >AnnotationHolder</code> syntax starting 2020.2, which uses the builder format.</p></aside><div class="code-block" data-lang="java"       data-disable-link-processing="true"  ></div><aside data-type="tip" class="prompt" data-title="" id="94564f3c_41" ><p id="94564f3c_42" >If the above code is copied at this stage of the tutorial, then remove the line below the comment &quot;** Tutorial step 18.3 …&quot; The quick fix class in that line is not defined until later in the tutorial.</p></aside></section><section class="chapter"  ><h2 id="register-the-annotator" data-toc="register-the-annotator"  >Register the Annotator</h2><p id="94564f3c_43" >Using the <code class="code " id="94564f3c_44"  >com.intellij.annotator</code> extension point in the plugin configuration file, register the Simple Language annotator class for <code class="code " id="94564f3c_45"  >JAVA</code> language:</p><div class="code-block" data-lang="markup"         >
&lt;extensions defaultExtensionNs=&quot;com.intellij&quot;&gt;
  &lt;annotator
      language=&quot;JAVA&quot;
      implementationClass=&quot;org.intellij.sdk.language.SimpleAnnotator&quot;/&gt;
&lt;/extensions&gt;
</div></section><section class="chapter"  ><h2 id="run-the-project" data-toc="run-the-project"  >Run the Project</h2><p id="94564f3c_47" >Run the plugin by using the Gradle <a href="gradle-prerequisites.html#running-a-simple-gradle-based-intellij-platform-plugin" id="94564f3c_48" data-tooltip="Gradle projects are run from the IDE's Gradle Tool window."  ><code class="code " id="94564f3c_49"  >runIde</code></a> task.</p><p id="94564f3c_50" >As a test, define the following Java file containing a Simple Language <code class="code " id="94564f3c_51"  >prefix:value</code> pair:</p><div class="code-block" data-lang="java"         >
public class Test {
  public static void main(String[] args) {
    System.out.println(&quot;simple:website&quot;);
  }
}
</div><p id="94564f3c_53" >Open this Java file in an IDE Development Instance running the <code class="code " id="94564f3c_54"  >simple_language_plugin</code> to check if the IDE resolves a property:</p><figure  id="94564f3c_55"><img alt="Annotator" title="Annotator" src="images/annotator.png"  class="" width="800" height="235"/></figure><p id="94564f3c_56" >If the property is an undefined name, the annotator flags the code with an error.</p><figure  id="94564f3c_57"><img alt="Unresolved property" title="Unresolved property" src="images/unresolved_property.png"  class="" width="800" height="313"/></figure><p id="94564f3c_58" >Try changing the Simple Language <a href="syntax-highlighter-and-color-settings-page.html#run-the-project" id="94564f3c_59" data-tooltip="Run the project by using the Gradle runIde task."  >color settings</a> to differentiate the annotation from the default language color settings.</p></section><div class="last-modified"> Last modified: 28 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="psi-helper-and-utilities.html">6. PSI Helpers and Utilities</a>   <a class="navigation-links__next" href="line-marker-provider.html">8. Line Marker Provider</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>