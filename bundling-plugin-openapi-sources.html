<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-29T19:15:56.505179"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>Bundling Plugin API Sources | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"api-sources-location","level":0,"title":"API sources location","anchor":"#api-sources-location"},{"id":"defining-plugin-api","level":0,"title":"Defining Plugin API","anchor":"#defining-plugin-api"},{"id":"bundling-api-sources-in-gradle-build-script","level":0,"title":"Bundling API Sources in Gradle Build Script","anchor":"#bundling-api-sources-in-gradle-build-script"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Bundling Plugin API Sources | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/bundling-plugin-openapi-sources.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="Bundling Plugin API Sources | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/bundling-plugin-openapi-sources.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/bundling-plugin-openapi-sources.html", "name": "Bundling Plugin API Sources | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="bundling_plugin_openapi_sources.md" data-main-title="Bundling Plugin API Sources" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part I — 插件///plugin_structure.md|Plugin Structure"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/basics/bundling_plugin_openapi_sources.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="bundling_plugin_openapi_sources.md" id="bundling_plugin_openapi_sources.md"  >Bundling Plugin API Sources</h1><p id="456ec6f0_39" >If a plugin exposes its own API that is meant to be used by other plugins, it is worth considering bundling the plugin's API sources in the ZIP distribution.</p><p id="456ec6f0_40" >If a third-party plugin uses <a href="tools-gradle-intellij-plugin.html" id="456ec6f0_41" data-tooltip="The Gradle IntelliJ Plugin is a plugin for the Gradle build system to help configuring your environment for building, testing, verifying, and publishing plugins for IntelliJ-based IDEs."  >Gradle IntelliJ Plugin</a> and adds a dependency to the plugin which bundles sources in the ZIP distribution, sources will be automatically attached to the plugin library and visible in IDE when developers navigate to the API classes. Being able to see API sources drastically improves the development experience, and it is highly recommended to bundle them.</p><aside data-type="tip" class="prompt" data-title="" id="456ec6f0_42" ><p id="456ec6f0_43" >Attaching bundled plugin sources in IDE is available starting with Gradle IntelliJ Plugin 1.7.0.</p></aside><section class="chapter"  ><h2 id="api-sources-location" data-toc="api-sources-location"  >API sources location</h2><p id="456ec6f0_44" >The API source JARs must be located in the <span class="filepath" id="456ec6f0_45" >example-plugin.zip!/plugin/lib/src</span> directory in the plugin ZIP distribution, e.g.:</p><div class="code-block" data-lang="plaintext"         >
example-plugin.zip
└── example-plugin
    └── lib
        ├── example-plugin.jar
        └── src
            └── example-plugin-api-src.jar
</div><p id="456ec6f0_47" >The plugin ZIP can contain multiple source JARs, and there are no strict rules for the source JAR names.</p></section><section class="chapter"  ><h2 id="defining-plugin-api" data-toc="defining-plugin-api"  >Defining Plugin API</h2><p id="456ec6f0_48" >Usually, the following classes are considered as plugin API:</p><ul class="list _ul" id="456ec6f0_49"    ><li class="list__item" id="456ec6f0_50" ><p><a href="plugin-extension-points.html" id="456ec6f0_51" data-tooltip="See Plugin Extensions for using extension points in your plugin."  >Extension Point</a> and related classes</p></li><li class="list__item" id="456ec6f0_52" ><p><a href="plugin-listeners.html" id="456ec6f0_53" data-tooltip="Listeners allow subscription to application and project events."  >Listener</a> and related classes</p></li><li class="list__item" id="456ec6f0_54" ><p><a href="plugin-services.html" id="456ec6f0_55" data-tooltip="A service is a plugin component loaded on demand when your plugin calls the getService() method of corresponding ComponentManager instance (see Types). The IntelliJ Platform ensures that only one instance of a service is loaded even though it is called several times."  >Services</a> and utilities that provide access to the plugin data/behavior</p></li></ul><p id="456ec6f0_56" >Keep in mind that API should be stable and change very rarely as every incompatible change will break the client plugins. It is also recommended to organize the plugin code in multiple modules with clear responsibilities, e.g.:</p><ul class="list _ul" id="456ec6f0_57"    ><li class="list__item" id="456ec6f0_58" ><p><code class="code " id="456ec6f0_59"  >example-plugin-api</code> - a module containing API</p></li><li class="list__item" id="456ec6f0_60" ><p><code class="code " id="456ec6f0_61"  >example-plugin-impl</code> - a module containing plugin features code that are not meant to be extended or used by client plugins</p></li></ul><p id="456ec6f0_62" >General rule to define API is to include classes that are likely to be consumed by the client plugins code.</p><p id="456ec6f0_63" >Of course, more complex plugins may require more fine-grained structure. See <a href="tools-gradle-intellij-plugin-examples.html" id="456ec6f0_64" data-tooltip="Marketplace platform provides the IntelliJ Platform Explorer – a search tool for browsing Extension Points inside existing implementations of open-source IntelliJ Platform plugins."  >Gradle IntelliJ Plugin - Usage Examples</a>.</p></section><section class="chapter"  ><h2 id="bundling-api-sources-in-gradle-build-script" data-toc="bundling-api-sources-in-gradle-build-script"  >Bundling API Sources in Gradle Build Script</h2><p id="456ec6f0_65" >In the simplest case, if a project consists of a single module and plugin API is clearly isolated in a package, e.g. <code class="code " id="456ec6f0_66"  >com.example.plugin.openapi</code>, including the source JAR can be achieved by adding the following snippet to the <code class="code " id="456ec6f0_67"  >tasks</code> section of the Gradle build script:</p><div class="tabs" id="456ec6f0_68"><div class="tabs__content" data-gtm="tab" id="456ec6f0_69"   data-title="Kotlin" ><div class="code-block" data-lang="kotlin"    data-title="Kotlin"     >
tasks {
  val createOpenApiSourceJar by registering(Jar::class) {
    // Java sources
    from(sourceSets.main.get().java) {
      include(&quot;**/com/example/plugin/openapi/**/*.java&quot;)
    }
    // Kotlin sources
    from(kotlin.sourceSets.main.get().kotlin) {
      include(&quot;**/com/example/plugin/openapi/**/*.kt&quot;)
    }
    destinationDirectory.set(layout.buildDirectory.dir(&quot;libs&quot;))
    archiveClassifier.set(&quot;src&quot;)
  }

  buildPlugin {
    dependsOn(createOpenApiSourceJar)
    from(createOpenApiSourceJar) { into(&quot;lib/src&quot;) }
  }
}
</div></div><div class="tabs__content" data-gtm="tab" id="456ec6f0_71"   data-title="Groovy" ><div class="code-block" data-lang="groovy"    data-title="Groovy"     >
task createOpenApiSourceJar(type: Jar) {
  // Java sources
  from(sourceSets.main.java) {
    include '**/com/example/plugin/openapi/**/*.java'
  }
  // Kotlin sources
  from(sourceSets.main.kotlin) {
    include '**/com/example/plugin/openapi/**/*.kt'
  }
  destinationDirectory = layout.buildDirectory.dir('libs')
  archiveClassifier = 'src'
}

buildPlugin {
  dependsOn(createOpenApiSourceJar)
  from(createOpenApiSourceJar) { into 'lib/src' }
}
</div></div></div><p id="456ec6f0_73" >The above configuration will create a source JAR containing Java and Kotlin source files from the <code class="code " id="456ec6f0_74"  >com.example.plugin.openapi</code> package and add it to the final plugin ZIP distribution in the required <span class="filepath" id="456ec6f0_75" >example-plugin.zip!/example-plugin/lib/src</span> directory.</p><p id="456ec6f0_76" >If your plugin is a Gradle project and there is no clear open API package separation, it is recommended to restructure the plugin project to a Gradle multi-project variant and create a dedicated open API subproject that contains all API sources to be included in the final distribution created by the main plugin Gradle project.</p></section><div class="last-modified"> Last modified: 29 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="plugin-content.html">Plugin Content</a>   <a class="navigation-links__next" href="plugin-class-loaders.html">Class Loaders</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>