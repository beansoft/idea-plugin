<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-28T11:33:50.296414"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>Syntax and Error Highlighting | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"color-settings","level":0,"title":"Color Settings","anchor":"#color-settings"},{"id":"lexer","level":0,"title":"Lexer","anchor":"#lexer"},{"id":"parser","level":0,"title":"Parser","anchor":"#parser"},{"id":"annotator","level":0,"title":"Annotator","anchor":"#annotator"},{"id":"external-tool","level":0,"title":"External Tool","anchor":"#external-tool"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Syntax and Error Highlighting | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/syntax-highlighting-and-error-highlighting.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="Syntax and Error Highlighting | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/syntax-highlighting-and-error-highlighting.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/syntax-highlighting-and-error-highlighting.html", "name": "Syntax and Error Highlighting | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="syntax_highlighting_and_error_highlighting.md" data-main-title="Syntax and Error Highlighting" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part VII — Custom Languages///custom_language_support.md|Custom Language Support"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/reference_guide/custom_language_support/syntax_highlighting_and_error_highlighting.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="syntax_highlighting_and_error_highlighting.md" id="syntax_highlighting_and_error_highlighting.md"  >Syntax and Error Highlighting</h1><p id="78046ead_1" >The class used to specify how a particular range of text should be highlighted is called <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/openapi/editor/colors/TextAttributesKey.java" id="78046ead_2"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_3"  >TextAttributesKey</code></a>. An instance of this class is created for every distinct type of item that should be highlighted (keyword, number, string, etc.). The <code class="code " id="78046ead_4"  >TextAttributesKey</code> defines the default attributes applied to items of the corresponding type (for example, keywords are bold, numbers are blue, strings are bold and green). Highlighting from multiple <code class="code " id="78046ead_5"  >TextAttributesKey</code> items can be layered - for example, one key may define an item's boldness and another color.</p><p id="78046ead_6" >Existing highlighting can be suppressed programmatically in certain contexts, see <a href="controlling-highlighting.html" id="78046ead_7" data-tooltip="The results of analyzing code by several mechanisms provided by the IntelliJ Platform (Syntax errors, Annotators, Inspections) are converted to highlighting information used to highlight the code in the editor. However, in some contexts, the provided highlighting information is…"  >Controlling Highlighting</a>.</p><aside data-type="tip" class="prompt" data-title="" id="78046ead_8" ><p id="78046ead_9" >To force re-highlighting (e.g., after changing plugin specific settings), use <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/codeInsight/daemon/DaemonCodeAnalyzer.java" id="78046ead_10"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_11"  >DaemonCodeAnalyzer.restart()</code></a>.</p></aside><section class="chapter"  ><h2 id="color-settings" data-toc="color-settings"  >Color Settings</h2><p id="78046ead_12" >The mapping of the <code class="code " id="78046ead_13"  >TextAttributesKey</code> to specific attributes used in an editor is defined by the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/editor-ui-api/src/com/intellij/openapi/editor/colors/EditorColorsScheme.java" id="78046ead_14"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_15"  >EditorColorsScheme</code></a> class. It can be configured by the user by providing an implementation of <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/platform-api/src/com/intellij/openapi/options/colors/ColorSettingsPage.java" id="78046ead_16"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_17"  >ColorSettingPage</code></a> registered in <code class="code " id="78046ead_18"  >com.intellij.colorSettingsPage</code> extension point.</p><p id="78046ead_19" >The  feature uses the same syntax highlighting mechanism as the editor. Thus, it will work automatically for custom languages that provide a syntax highlighter.</p><p id="78046ead_21" ><span class="control" id="78046ead_22" >Examples</span>:</p><ul class="list _ul" id="78046ead_23"    ><li class="list__item" id="78046ead_24" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties/src/com/intellij/lang/properties/PropertiesColorsPage.java" id="78046ead_25"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_26"  >ColorSettingsPage</code></a> for <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties" id="78046ead_27"   data-external="true" rel="noopener noreferrer" >Properties language plugin</a></p></li><li class="list__item" id="78046ead_28" ><p><a href="syntax-highlighter-and-color-settings-page.html" id="78046ead_29" data-tooltip="Reference:"  >Custom Language Support Tutorial: Color Settings Page</a></p></li></ul><aside data-type="tip" class="prompt" data-title="" id="78046ead_30" ><p id="78046ead_31" >New functionality about Language Defaults and support for additional color schemes are detailed in <a href="color-scheme-management.html" id="78046ead_32" data-tooltip="Color scheme management in IntelliJ IDEA 12.1 was changed to ease scheme designers' work and make schemes look equally well for different programming languages even if not designed specifically for these languages. Previously language plug-ins were using fixed default colors…"  >Color Scheme Management</a>.</p></aside><p id="78046ead_33" >The syntax and error highlighting are performed on multiple levels: Lexer, Parser, and (External) Annotator(s).</p></section><section class="chapter"  ><h2 id="lexer" data-toc="lexer"  >Lexer</h2><p id="78046ead_34" >The first syntax highlighting level is based on the lexer output and is provided through the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/editor-ui-api/src/com/intellij/openapi/fileTypes/SyntaxHighlighter.java" id="78046ead_35"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_36"  >SyntaxHighlighter</code></a> interface. The syntax highlighter returns the <code class="code " id="78046ead_37"  >TextAttributesKey</code> instances for each token type, which needs special highlighting. For highlighting lexer errors, the standard <code class="code " id="78046ead_38"  >TextAttributesKey</code> for bad characters <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/editor-ui-api/src/com/intellij/openapi/editor/HighlighterColors.java" id="78046ead_39"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_40"  >HighlighterColors.BAD_CHARACTER</code></a> can be used.</p><p id="78046ead_41" ><span class="control" id="78046ead_42" >Examples:</span></p><ul class="list _ul" id="78046ead_43"    ><li class="list__item" id="78046ead_44" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties/properties-psi-api/src/com/intellij/lang/properties/PropertiesHighlighter.java" id="78046ead_45"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_46"  >SyntaxHighlighter</code></a> implementation for <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties" id="78046ead_47"   data-external="true" rel="noopener noreferrer" >Properties language plugin</a></p></li><li class="list__item" id="78046ead_48" ><p><a href="syntax-highlighter-and-color-settings-page.html" id="78046ead_49" data-tooltip="Reference:"  >Custom Language Support Tutorial: Syntax Highlighter</a></p></li></ul><aside data-type="tip" class="prompt" data-title="" id="78046ead_50" ><p id="78046ead_51" >Use <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/openapi/editor/richcopy/HtmlSyntaxInfoUtil.java" id="78046ead_52"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_53"  >HtmlSyntaxInfoUtil</code></a> to create Lexer-based highlighted code samples, e.g. for usage in documentation.</p></aside><section class="chapter"  ><h3 id="semantic-highlighting" data-toc="semantic-highlighting"  >Semantic Highlighting</h3><p id="78046ead_54" ><a href="https://www.jetbrains.com/help/idea/configuring-colors-and-fonts.html#semantic-highlighting" id="78046ead_55"   data-external="true" rel="noopener noreferrer" >Semantic highlighting</a> provides an additional coloring layer to improve the visual distinction of several related items (e.g., method parameters, local variables).</p><p id="78046ead_56" >Register <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-impl/src/com/intellij/codeInsight/daemon/RainbowVisitor.java" id="78046ead_57"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_58"  >RainbowVisitor</code></a> in <code class="code " id="78046ead_59"  >com.intellij.highlightVisitor</code> extension point. <a href="#color-settings" id="78046ead_60" data-tooltip="The mapping of the TextAttributesKey to specific attributes used in an editor is defined by the EditorColorsScheme class. It can be configured by the user by providing an implementation of ColorSettingPage registered in com.intellij.colorSettingsPage extension point."  >Color Settings</a> must implement <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/platform-api/src/com/intellij/openapi/options/colors/RainbowColorSettingsPage.java" id="78046ead_61"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_62"  >RainbowColorSettingsPage</code></a> in addition.</p></section></section><section class="chapter"  ><h2 id="parser" data-toc="parser"  >Parser</h2><p id="78046ead_63" >The second level of error highlighting happens during parsing. If a particular sequence of tokens is invalid according to the grammar of the language, the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/lang/PsiBuilder.java" id="78046ead_64"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_65"  >PsiBuilder.error()</code></a> method can highlight the invalid tokens and display an error message showing why they are not valid.</p><p id="78046ead_66" >See <a href="syntax-errors.html" id="78046ead_67" data-tooltip="The IntelliJ Platform provides a mechanism for analyzing the PSI tree and highlighting syntax errors out of the box."  >Syntax Errors</a> on how to programmatically suppress these errors in certain contexts.</p></section><section class="chapter"  ><h2 id="annotator" data-toc="annotator"  >Annotator</h2><p id="78046ead_68" >The third level of highlighting is performed through the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/lang/annotation/Annotator.java" id="78046ead_69"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_70"  >Annotator</code></a> interface. A plugin can register one or more annotators in the <code class="code " id="78046ead_71"  >com.intellij.annotator</code> extension point, and these annotators are called during the background highlighting pass to process the elements in the custom language's PSI tree. Attribute <code class="code " id="78046ead_72"  >language</code> should be set to the Language ID where this annotator applies to.</p><p id="78046ead_73" >Annotators can analyze not only the syntax, but also the semantics using PSI, and thus can provide much more complex syntax and error highlighting logic. The annotator can also provide quick fixes to problems it detects. When the file is changed, the annotator is called incrementally to process only changed elements in the PSI tree.</p><aside data-type="tip" class="prompt" data-title="" id="78046ead_74" ><p id="78046ead_75" >See also <a href="code-inspections-and-intentions.html" id="78046ead_76" data-tooltip="The code inspections for custom languages use the same API as all other code inspections, based on the LocalInspectionTool class."  >Code Inspections</a> which offer a more fine-grained control and some additional features.</p></aside><section class="chapter"  ><h3 id="errorswarning" data-toc="errorswarning"  >Errors/Warning</h3><p id="78046ead_77" >See <a href="https://jetbrains.design/intellij/text/inspections/" id="78046ead_78"   data-external="true" rel="noopener noreferrer" >Inspections</a> topic in IntelliJ Platform UI Guidelines on how to write message texts for highlighting/quick fixes.</p><p id="78046ead_79" >To highlight a region of text as a warning or error:</p><div class="tabs" id="78046ead_80"data-group="platform-version"><div class="tabs__content" data-gtm="tab" id="78046ead_81" data-sync-tabs="2020.1"  data-title="2020.1 and later" ><div class="code-block" data-lang="java"    data-title="Java"     >
    holder.newAnnotation(HighlightSeverity.WARNING, &quot;Invalid code&quot;) // or HighlightSeverity.ERROR
        .withFix(new MyFix(psiElement))
        .create();
</div></div><div class="tabs__content" data-gtm="tab" id="78046ead_83" data-sync-tabs="pre-2020.1"  data-title="Pre-2020.1" ><p id="78046ead_84" >Call <code class="code " id="78046ead_85"  >createWarningAnnotation()</code>/<code class="code " id="78046ead_86"  >createErrorAnnotation()</code> on the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/lang/annotation/AnnotationHolder.java" id="78046ead_87"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_88"  >AnnotationHolder</code></a>, and optionally calls <code class="code " id="78046ead_89"  >registerFix()</code> on the returned <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/lang/annotation/Annotation.java" id="78046ead_90"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_91"  >Annotation</code></a> object to add a quick fix for the error or warning.</p></div></div></section><section class="chapter"  ><h3 id="syntax" data-toc="syntax"  >Syntax</h3><p id="78046ead_92" >To apply additional syntax highlighting (2020.1 and later):</p><div class="tabs" id="78046ead_93"data-group="platform-version"><div class="tabs__content" data-gtm="tab" id="78046ead_94" data-sync-tabs="2020.1"  data-title="2020.1 and later" ><div class="code-block" data-lang="java"    data-title="Java"     >
    holder.newSilentAnnotation(HighlightSeverity.INFORMATION)
            .range(rangeToHighlight)
            .textAttributes(MyHighlighter.EXTRA_HIGHLIGHT_ATTRIBUTE)
            .create();
</div></div><div class="tabs__content" data-gtm="tab" id="78046ead_96" data-sync-tabs="pre-2020.1"  data-title="Pre-2020.1" ><p id="78046ead_97" >Call <code class="code " id="78046ead_98"  >AnnotationHolder.createInfoAnnotation()</code> with an empty message and then <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/lang/annotation/Annotation.java" id="78046ead_99"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_100"  >Annotation.setTextAttributes()</code></a>.</p></div></div><p id="78046ead_101" ><span class="control" id="78046ead_102" >Examples:</span></p><ul class="list _ul" id="78046ead_103"    ><li class="list__item" id="78046ead_104" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties/properties-psi-impl/src/com/intellij/lang/properties/PropertiesAnnotator.java" id="78046ead_105"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_106"  >Annotator</code></a> for <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties" id="78046ead_107"   data-external="true" rel="noopener noreferrer" >Properties language plugin</a></p></li><li class="list__item" id="78046ead_108" ><p><a href="annotator.html" id="78046ead_109" data-tooltip="Reference:"  >Custom Language Support Tutorial: Annotator</a></p></li></ul></section></section><section class="chapter"  ><h2 id="external-tool" data-toc="external-tool"  >External Tool</h2><p id="78046ead_110" >Finally, if the custom language employs external tools for validating files in the language (for example, uses the Xerces library for XML schema validation), it can provide an implementation of the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/lang/annotation/ExternalAnnotator.java" id="78046ead_111"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_112"  >ExternalAnnotator</code></a> interface and register it in <code class="code " id="78046ead_113"  >com.intellij.externalAnnotator</code> extension point (<code class="code " id="78046ead_114"  >language</code> attribute must be specified).</p><p id="78046ead_115" >The <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/lang/annotation/ExternalAnnotator.java" id="78046ead_116"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_117"  >ExternalAnnotator</code></a> highlighting has the lowest priority and is invoked only after all other background processing has completed. It uses the same <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/lang/annotation/AnnotationHolder.java" id="78046ead_118"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_119"  >AnnotationHolder</code></a> interface for converting the output of the external tool into editor highlighting.</p><p id="78046ead_120" >To skip running specific <code class="code " id="78046ead_121"  >ExternalAnnotator</code> for given file, register <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/lang/ExternalAnnotatorsFilter.java" id="78046ead_122"   data-external="true" rel="noopener noreferrer" ><code class="code " id="78046ead_123"  >ExternalAnnotatorsFilter</code></a> extension in <code class="code " id="78046ead_124"  >com.intellij.daemon.externalAnnotatorsFilter</code> extension point.</p></section><div class="last-modified"> Last modified: 28 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="implementing-parser-and-psi.html">Implementing Parser and PSI</a>   <a class="navigation-links__next" href="references-and-resolve.html">References and Resolve</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>