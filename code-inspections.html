<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-29T19:15:56.4591686"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>Code Inspections | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"creating-an-inspection-plugin","level":0,"title":"Creating an Inspection Plugin","anchor":"#creating-an-inspection-plugin"},{"id":"creating-an-inspection","level":0,"title":"Creating an Inspection","anchor":"#creating-an-inspection"},{"id":"running-the-comparing-references-inspection-code-sample","level":0,"title":"Running the Comparing References Inspection Code Sample","anchor":"#running-the-comparing-references-inspection-code-sample"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Code Inspections | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/code-inspections.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="Code Inspections | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/code-inspections.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/code-inspections.html", "name": "Code Inspections | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="code_inspections.md" data-main-title="Code Inspections" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part V — Features///analyzing.md|Analysing"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/tutorials/code_inspections.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="code_inspections.md" id="code_inspections.md"  >Code Inspections</h1><p id="bd068086_261" >The IntelliJ Platform provides tools designed for static code analysis called <span class="emphasis" id="bd068086_262" >code inspections</span>, which help the user maintain and clean up code without actually executing it. Custom code inspections can be implemented as IntelliJ Platform plugins. Examples of the plugin approach are the IntelliJ Platform SDK code samples <a href="https://github.com/JetBrains/intellij-sdk-code-samples/tree/main/inspection_basics" id="bd068086_263"   data-external="true" rel="noopener noreferrer" >inspection_basics</a> and <a href="https://github.com/JetBrains/intellij-sdk-code-samples/tree/main/comparing_references_inspection" id="bd068086_264"   data-external="true" rel="noopener noreferrer" >comparing_references_inspection</a>. In addition, the comparing_references_inspection code sample demonstrates implementing a unit test.</p><p id="bd068086_265" >You can also create custom inspections through the IntelliJ IDEA user interface. See <a href="https://www.jetbrains.com/idea/webhelp/code-inspection.html" id="bd068086_266"   data-external="true" rel="noopener noreferrer" >Code Inspection</a> and <a href="https://www.jetbrains.com/idea/help/creating-custom-inspections.html" id="bd068086_267"   data-external="true" rel="noopener noreferrer" >Creating Custom Inspections</a> for more information.</p><p id="bd068086_268" >See <a href="https://jetbrains.design/intellij/text/inspections/" id="bd068086_269"   data-external="true" rel="noopener noreferrer" >Inspections</a> topic in the IntelliJ Platform UI Guidelines on naming, writing description, and message texts for inspections.</p><section class="chapter"  ><h2 id="creating-an-inspection-plugin" data-toc="creating-an-inspection-plugin"  >Creating an Inspection Plugin</h2><p id="bd068086_270" >The <a href="https://github.com/JetBrains/intellij-sdk-code-samples/tree/main/comparing_references_inspection" id="bd068086_271"   data-external="true" rel="noopener noreferrer" >comparing_references_inspection</a> code sample adds a new inspection to the <span class="control" id="bd068086_272" >Java | Probable Bugs</span> group in the <a href="https://www.jetbrains.com/help/idea/inspections-settings.html" id="bd068086_273"   data-external="true" rel="noopener noreferrer" >Inspections list</a>. The inspection reports when the <code class="code " id="bd068086_274"  >==</code> or <code class="code " id="bd068086_275"  >!=</code> operator is used between Java expressions of reference types.</p><p id="bd068086_276" >It illustrates the components for a custom inspection plugin:</p><ul class="list _ul" id="bd068086_277"    ><li class="list__item" id="bd068086_278" ><p>Describing an <a href="#plugin-configuration-file" id="bd068086_279" data-tooltip="The comparing_references_inspection is described as a com.intellij.localInspection extension point in the comparing_references_inspection plugin configuration (plugin.xml) file."  >inspection</a> in the plugin configuration file.</p></li><li class="list__item" id="bd068086_280" ><p>Implementing a <a href="#inspection-implementation-java-class" id="bd068086_281" data-tooltip="Inspection implementations for Java files, like ComparingReferencesInspection, are often based on the Java class AbstractBaseJavaLocalInspectionTool. The AbstractBaseJavaLocalInspectionTool base class offers methods to inspect Java classes, fields, and methods."  >local inspection class</a> to inspect Java code in the editor.</p></li><li class="list__item" id="bd068086_282" ><p>Creating a <a href="#visitor-implementation-class" id="bd068086_283" data-tooltip="The visitor class evaluates whether elements of the file's PSI tree are of interest to an inspection."  >visitor</a> to traverse the PSI tree of the Java file being edited, inspecting for problematic syntax.</p></li><li class="list__item" id="bd068086_284" ><p>Implementing a <a href="#quick-fix-implementation" id="bd068086_285" data-tooltip="The quick fix class acts much like an intention, allowing the user to invoke it on the PsiElement (or TextRange) highlighted by the inspection."  >quick fix</a> class to correct syntax problems by altering the PSI tree as needed. Quick fixes are displayed to the user like <a href="code-intentions.html" id="bd068086_286" data-tooltip="This topic describes the conditional_operator_intention, a sample plugin that adds a new intention action to the IDE Intentions list. In addition, the sample plugin contains a JUnit-based test."  >intentions</a>.</p></li><li class="list__item" id="bd068086_287" ><p>Implementing an <a href="#inspection-preferences-panel" id="bd068086_288" data-tooltip="The inspection preferences panel is used to display information and provide additional options for the inspection."  >inspection preferences panel</a> to display information about the inspection.</p></li><li class="list__item" id="bd068086_289" ><p>Writing an HTML <a href="#inspection-description" id="bd068086_290" data-tooltip="The inspection description is an HTML file. The description is displayed in the upper right panel of the Inspections settings dialog when an inspection is selected from the list."  >description</a> of the inspection for display in the inspection preferences panel.</p></li><li class="list__item" id="bd068086_291" ><p>Optionally, create a <a href="#inspection-unit-test" id="bd068086_292" data-tooltip="Please note that running the test requires setting system property idea.home.path in the test task configuration of the Gradle build script."  >unit test</a> for the plugin.</p></li></ul><p id="bd068086_293" >Although the IntelliJ Platform SDK code samples illustrate implementations of these components, it is often useful to see examples of inspections implemented in the <span class="emphasis" id="bd068086_294" >intellij_community</span> code base. This process can help find inspection descriptions and implementations based on what is visible in the IDE UI. The overall approach works for inspections aimed at other languages as well.</p><ul class="list _ul" id="bd068086_295"    ><li class="list__item" id="bd068086_296" ><p>Find an existing inspection that is similar to the one you want to implement in the </p><p> panel. Note the display name of the inspection. For example, the Java/Probable Bugs inspection <span class="control" id="bd068086_298" >Object comparison using '==', instead of 'equals()'</span> is very similar to <code class="code " id="bd068086_299"  >comparing_references_inspection</code>.</p></li><li class="list__item" id="bd068086_300" ><p>Use the display name text as the <a href="https://www.jetbrains.com/help/idea/finding-and-replacing-text-in-project.html" id="bd068086_301"   data-external="true" rel="noopener noreferrer" >target for a search</a> within the <span class="emphasis" id="bd068086_302" >intellij_community</span> project. This will identify a bundle file if the display name is localized. If it is not localized, the search finds either the <span class="filepath" id="bd068086_303" ><a href="plugin-configuration-file.html" id="bd068086_304" data-tooltip="Plugin configuration file contains all the information about the plugin, as well as all registered extensions, actions, listeners, etc."  >plugin.xml</a></span> file where it is an attribute in the inspection description, or the implementation where it is provided by an overridden method.</p></li><li class="list__item" id="bd068086_305" ><p>In the case of localization, copy the key from the bundle file identified by the search. </p><ul class="list _ul" id="bd068086_306"    ><li class="list__item" id="bd068086_307" ><p>Use the key text as the target for a search within the <span class="emphasis" id="bd068086_308" >intellij_community</span> project. This search locates the plugin configuration file that describes the inspection.</p></li><li class="list__item" id="bd068086_309" ><p>From the inspection description entry, find the <code class="code " id="bd068086_310"  >implementationClass</code> attribute value.</p></li></ul></li><li class="list__item" id="bd068086_311" ><p>Use the <code class="code " id="bd068086_312"  >implementationClass</code> text as the <a href="https://www.jetbrains.com/help/idea/searching-everywhere.html#Searching_Everywhere.xml" id="bd068086_313"   data-external="true" rel="noopener noreferrer" >target of a class search</a> in the <span class="emphasis" id="bd068086_314" >intellij_community</span> codebase to find the implementation.</p></li></ul><p id="bd068086_315" >See also <a href="explore-api.html" id="bd068086_316" data-tooltip="探索 API的策略和工具."  >探索 IntelliJ Platform API</a> for more information and strategies.</p></section><section class="chapter"  ><h2 id="creating-an-inspection" data-toc="creating-an-inspection"  >Creating an Inspection</h2><p id="bd068086_317" >The <a href="https://github.com/JetBrains/intellij-sdk-code-samples/tree/main/comparing_references_inspection" id="bd068086_318"   data-external="true" rel="noopener noreferrer" >comparing_references_inspection</a> code sample reports when the <code class="code " id="bd068086_319"  >==</code> or <code class="code " id="bd068086_320"  >!=</code> operators are used between Java expressions of reference types. The user can apply a quick fix to change <code class="code " id="bd068086_321"  >a==b</code> to <code class="code " id="bd068086_322"  >a.equals(b)</code>, or <code class="code " id="bd068086_323"  >a!=b</code> to <code class="code " id="bd068086_324"  >!a.equals(b)</code>.</p><p id="bd068086_325" >The details of the <code class="code " id="bd068086_326"  >comparing_references_inspection</code> implementation illustrate the components of an inspection plugin.</p><section class="chapter"  ><h3 id="plugin-configuration-file" data-toc="plugin-configuration-file"  >Plugin Configuration File</h3><p id="bd068086_327" >The <code class="code " id="bd068086_328"  >comparing_references_inspection</code> is described as a <code class="code " id="bd068086_329"  >com.intellij.localInspection</code> extension point in the <code class="code " id="bd068086_330"  >comparing_references_inspection</code> plugin configuration (<a href="https://github.com/JetBrains/intellij-sdk-code-samples/tree/main/comparing_references_inspection/src/main/resources/META-INF/plugin.xml" id="bd068086_331"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_332"  >plugin.xml</code></a>) file.</p><p id="bd068086_333" >There exist two types of inspection extensions:</p><ul class="list _ul" id="bd068086_334"    ><li class="list__item" id="bd068086_335" ><p>The <code class="code " id="bd068086_336"  >com.intellij.localInspection</code> extension point is used for inspections that operate on one file at a time, and also operate &quot;on-the-fly&quot; as the user edits the file.</p></li><li class="list__item" id="bd068086_337" ><p>The <code class="code " id="bd068086_338"  >com.intellij.globalInspection</code> extension point is used for inspections that operate across multiple files, and the associated fix might, for example, refactor code between files.</p></li></ul><p id="bd068086_339" >The minimum inspection setup must declare the <code class="code " id="bd068086_340"  >implementationClass</code> and <code class="code " id="bd068086_341"  >language</code> attribute (unless the inspection works on any supported language). As shown in the <code class="code " id="bd068086_342"  >comparing_references_inspection</code> plugin configuration file, other attributes can be defined in the <code class="code " id="bd068086_343"  >localInspection</code> element, either with or without localization. In most cases, it is simplest to define the attributes in the plugin configuration file because the underlying parent classes handle most of the class responsibilities based on the configuration file description. Note that some attributes are not displayed to the user, so they are never localized.</p><p id="bd068086_344" >If required, inspections can define all the attribute information (except <code class="code " id="bd068086_345"  >implementationClass</code>) by overriding methods in the inspection implementation class (not recommended in general).</p></section><section class="chapter"  ><h3 id="inspection-implementation-java-class" data-toc="inspection-implementation-java-class"  >Inspection Implementation Java Class</h3><p id="bd068086_346" >Inspection implementations for Java files, like <a href="https://github.com/JetBrains/intellij-sdk-code-samples/tree/main/comparing_references_inspection/src/main/java/org/intellij/sdk/codeInspection/ComparingReferencesInspection.java" id="bd068086_347"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_348"  >ComparingReferencesInspection</code></a>, are often based on the Java class <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/java/java-analysis-api/src/com/intellij/codeInspection/AbstractBaseJavaLocalInspectionTool.java" id="bd068086_349"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_350"  >AbstractBaseJavaLocalInspectionTool</code></a>. The <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/java/java-analysis-api/src/com/intellij/codeInspection/AbstractBaseJavaLocalInspectionTool.java" id="bd068086_351"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_352"  >AbstractBaseJavaLocalInspectionTool</code></a> base class offers methods to inspect Java classes, fields, and methods.</p><p id="bd068086_353" >More generally, <code class="code " id="bd068086_354"  >localInspection</code> types are based on the class <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/codeInspection/LocalInspectionTool.java" id="bd068086_355"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_356"  >LocalInspectionTool</code></a>. Examining the class hierarchy for <code class="code " id="bd068086_357"  >LocalInspectionTool</code> shows that the IntelliJ Platform provides many child inspection classes for a variety of languages and frameworks. One of these classes is a good basis for a new inspection implementation, but a bespoke implementation can also be based directly on <code class="code " id="bd068086_358"  >LocalInspectionTool</code>.</p><p id="bd068086_359" >The primary responsibilities of the inspection implementation class are to provide:</p><ul class="list _ul" id="bd068086_360"    ><li class="list__item" id="bd068086_361" ><p>A <code class="code " id="bd068086_362"  >PsiElementVisitor</code> object to traverse the PSI tree of the file being inspected.</p></li><li class="list__item" id="bd068086_363" ><p>A <code class="code " id="bd068086_364"  >LocalQuickFix</code> class to fix an identified problem.</p></li><li class="list__item" id="bd068086_365" ><p>A <code class="code " id="bd068086_366"  >JPanel</code> to be displayed in the <span class="control" id="bd068086_367" >Inspections</span> settings dialog.</p></li></ul><p id="bd068086_368" >The <code class="code " id="bd068086_369"  >ComparingReferencesInspection</code> class defines two <code class="code " id="bd068086_370"  >String</code> fields:</p><ul class="list _ul" id="bd068086_371"    ><li class="list__item" id="bd068086_372" ><p><code class="code " id="bd068086_373"  >QUICK_FIX_NAME</code> defines the string users see when prompted to apply the quick fix.</p></li><li class="list__item" id="bd068086_374" ><p><code class="code " id="bd068086_375"  >CHECKED_CLASSES</code> holds a list of class names of interest to the inspection.</p></li></ul><p id="bd068086_376" >The overridden <code class="code " id="bd068086_377"  >ComparingReferencesInspection</code> methods are discussed in the sections below.</p></section><section class="chapter"  ><h3 id="visitor-implementation-class" data-toc="visitor-implementation-class"  >Visitor Implementation Class</h3><p id="bd068086_378" >The visitor class evaluates whether elements of the file's PSI tree are of interest to an inspection.</p><p id="bd068086_379" >The <code class="code " id="bd068086_380"  >ComparingReferencesInspection.buildVisitor()</code> method creates an anonymous visitor class based on <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/java/java-psi-api/src/com/intellij/psi/JavaElementVisitor.java" id="bd068086_381"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_382"  >JavaElementVisitor</code></a> to traverse the PSI tree of the Java file being edited, inspecting for suspect syntax. The anonymous class overrides three methods in particular.</p><ul class="list _ul" id="bd068086_383"    ><li class="list__item" id="bd068086_384" ><p><code class="code " id="bd068086_385"  >visitReferenceExpression()</code> to prevent any duplicate visitation of reference-type expressions.</p></li><li class="list__item" id="bd068086_386" ><p><code class="code " id="bd068086_387"  >visitBinaryExpression()</code>, which does all the heavy lifting. It is called to evaluate a <code class="code " id="bd068086_388"  >PsiBinaryExpression</code>, and it checks to see if the operands are <code class="code " id="bd068086_389"  >==</code> or <code class="code " id="bd068086_390"  >!=</code>, and if the operands are classes relevant to this inspection.</p></li><li class="list__item" id="bd068086_391" ><p><code class="code " id="bd068086_392"  >isCheckedType()</code> evaluates the <code class="code " id="bd068086_393"  >PsiType</code> of the operands to determine if they are of interest to this inspection.</p></li></ul></section><section class="chapter"  ><h3 id="quick-fix-implementation" data-toc="quick-fix-implementation"  >Quick Fix Implementation</h3><p id="bd068086_394" >The quick fix class acts much like an intention, allowing the user to invoke it on the <code class="code " id="bd068086_395"  >PsiElement</code> (or <code class="code " id="bd068086_396"  >TextRange</code>) highlighted by the inspection.</p><p id="bd068086_397" >The <code class="code " id="bd068086_398"  >ComparingReferencesInspection</code> implementation uses the nested class <code class="code " id="bd068086_399"  >CriQuickFix</code> to implement a quick fix based on <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/codeInspection/LocalQuickFix.java" id="bd068086_400"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_401"  >LocalQuickFix</code></a>. The <code class="code " id="bd068086_402"  >CriQuickFix</code> class gives a user the option to change the use of <code class="code " id="bd068086_403"  >a == b</code> and <code class="code " id="bd068086_404"  >a != b</code> expression to <code class="code " id="bd068086_405"  >a.equals(b)</code> and <code class="code " id="bd068086_406"  >!a.equals(b)</code> respectively.</p><p id="bd068086_407" >The heavy lifting is done in <code class="code " id="bd068086_408"  >CriQuickFix.applyFix()</code>, which manipulates the PSI tree to convert the expressions. The change to the PSI tree is accomplished by the usual approach to modification:</p><ul class="list _ul" id="bd068086_409"    ><li class="list__item" id="bd068086_410" ><p>Getting a <code class="code " id="bd068086_411"  >PsiElementFactory</code>.</p></li><li class="list__item" id="bd068086_412" ><p>Creating a new <code class="code " id="bd068086_413"  >PsiMethodCallExpression</code>.</p></li><li class="list__item" id="bd068086_414" ><p>Substituting the original left and right operands into the new <code class="code " id="bd068086_415"  >PsiMethodCallExpression</code>.</p></li><li class="list__item" id="bd068086_416" ><p>Replacing the original binary expression with the <code class="code " id="bd068086_417"  >PsiMethodCallExpression</code>.</p></li></ul></section><section class="chapter"  ><h3 id="inspection-preferences-panel" data-toc="inspection-preferences-panel"  >Inspection Preferences Panel</h3><p id="bd068086_418" >The inspection preferences panel is used to display information and provide additional options for the inspection.</p><p id="bd068086_419" >The panel created by <code class="code " id="bd068086_420"  >ComparingReferencesInspection.createOptionsPanel()</code> just defines a single <code class="code " id="bd068086_421"  >JTextField</code> to display in a <code class="code " id="bd068086_422"  >JPanel</code>. This <code class="code " id="bd068086_423"  >JPanel</code> gets added to the <span class="control" id="bd068086_424" >Inspections</span> settings dialog when the inspection is selected. The <code class="code " id="bd068086_425"  >JTextField</code> allows editing of the <code class="code " id="bd068086_426"  >CHECKED_CLASSES</code> field while displayed in the panel.</p><p id="bd068086_427" >For simple customization requirements, see also:</p><ul class="list _ul" id="bd068086_428"    ><li class="list__item" id="bd068086_429" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-api/src/com/intellij/codeInspection/ui/SingleCheckboxOptionsPanel.java" id="bd068086_430"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_431"  >SingleCheckboxOptionsPanel</code></a> for single checkbox</p></li><li class="list__item" id="bd068086_432" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-api/src/com/intellij/codeInspection/ui/MultipleCheckboxOptionsPanel.java" id="bd068086_433"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_434"  >MultipleCheckboxOptionsPanel</code></a> for multiple checkboxes</p></li><li class="list__item" id="bd068086_435" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-api/src/com/intellij/codeInspection/ui/SingleIntegerFieldOptionsPanel.java" id="bd068086_436"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_437"  >SingleIntegerFieldOptionsPanel</code></a> for single Integer (text field)</p></li><li class="list__item" id="bd068086_438" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-api/src/com/intellij/codeInspection/ui/ConventionOptionsPanel.java" id="bd068086_439"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_440"  >ConventionOptionsPanel</code></a> for validation using regular expression</p></li></ul></section><section class="chapter"  ><h3 id="inspection-description" data-toc="inspection-description"  >Inspection Description</h3><p id="bd068086_441" >The inspection description is an HTML file. The description is displayed in the upper right panel of the <span class="control" id="bd068086_442" >Inspections</span> settings dialog when an inspection is selected from the list.</p><p id="bd068086_443" >Implicit in using <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/codeInspection/LocalInspectionTool.java" id="bd068086_444"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_445"  >LocalInspectionTool</code></a> in the class hierarchy of the inspection implementation means following some conventions.</p><ul class="list _ul" id="bd068086_446"    ><li class="list__item" id="bd068086_447" ><p>The inspection description file is expected to be located under <span class="filepath" id="bd068086_448" >$RESOURCES_ROOT_DIRECTORY$/inspectionDescriptions/</span>. If the inspection description file is to be located elsewhere, override <code class="code " id="bd068086_449"  >getDescriptionUrl()</code> in the inspection implementation class.</p></li><li class="list__item" id="bd068086_450" ><p>The name of the description file is expected to be the inspection <span class="filepath" id="bd068086_451" >$SHORT_NAME$.html</span> as provided by the inspection description, or the inspection implementation class. If a short name is not provided by the plugin, the IntelliJ Platform computes one by removing <code class="code " id="bd068086_452"  >Inspection</code> suffix from the implementation class name.</p></li></ul><aside data-type="tip" class="prompt" data-title="" id="bd068086_453" ><p id="bd068086_454" >To open related <a href="settings.html" id="bd068086_455" data-tooltip="Settings are but one application of the IntelliJ Platform Persistence Model. For more information, see:"  >settings</a> directly from the inspection description, add a link with <code class="code " id="bd068086_456"  >settings://$CONFIGURABLE_ID$</code>, optionally followed by <code class="code " id="bd068086_457"  >?$SEARCH_STRING$</code> to pre-select UI element:</p><p id="bd068086_458" ><code class="code " id="bd068086_459"  >See &lt;em&gt;Includes&lt;/em&gt; tab in &lt;a href=&quot;settings://fileTemplates&quot;&gt;Settings/Preferences | Editor | File and Code Templates&lt;/a&gt; to configure.</code></p></aside></section><section class="chapter"  ><h3 id="inspection-unit-test" data-toc="inspection-unit-test"  >Inspection Unit Test</h3><aside data-type="tip" class="prompt" data-title="" id="bd068086_460" ><p id="bd068086_461" >Please note that running the test requires setting system property <code class="code " id="bd068086_462"  >idea.home.path</code> in the <code class="code " id="bd068086_463"  >test</code> task configuration of the Gradle build script.</p></aside><p id="bd068086_464" >The <code class="code " id="bd068086_465"  >comparing_references_inspection</code> code sample provides a unit test for the inspection. See the <a href="testing-plugins.html" id="bd068086_466" data-tooltip="Most of the tests in the IntelliJ Platform codebase are model-level functional tests. What this means is the following:"  >Testing Overview</a> section for general information about plugin testing.</p><p id="bd068086_467" >The <code class="code " id="bd068086_468"  >comparing_references_inspection</code> test is based on the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/testFramework/src/com/intellij/testFramework/UsefulTestCase.java" id="bd068086_469"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bd068086_470"  >UsefulTestCase</code></a> class, part of the JUnit framework APIs. This class handles much of the underlying boilerplate for tests.</p><p id="bd068086_471" >By convention, the folder <span class="filepath" id="bd068086_472" >test/testData/</span> contains the test files. The folder contains pairs of files for each test using the name convention <span class="filepath" id="bd068086_473" >∗.java</span> and <span class="filepath" id="bd068086_474" >∗.after.java</span>.</p><p id="bd068086_475" >In the case of <code class="code " id="bd068086_476"  >comparing_references_inspection</code> the test files are <span class="filepath" id="bd068086_477" >Eq.java</span>/<span class="filepath" id="bd068086_478" >Eq.after.java</span>, and <span class="filepath" id="bd068086_479" >Neq.java</span>/<span class="filepath" id="bd068086_480" >Neq.after.java</span>.</p><p id="bd068086_481" >The <code class="code " id="bd068086_482"  >comparing_references_inspection</code> tests run the inspection on the <span class="filepath" id="bd068086_483" >∗.java</span> files, implement the quick fix, and compare the results with the respective <span class="filepath" id="bd068086_484" >∗.after.java</span> files containing expected result.</p></section></section><section class="chapter"  ><h2 id="running-the-comparing-references-inspection-code-sample" data-toc="running-the-comparing-references-inspection-code-sample"  >Running the Comparing References Inspection Code Sample</h2><p id="bd068086_485" >The <a href="https://github.com/JetBrains/intellij-sdk-code-samples/tree/main/comparing_references_inspection" id="bd068086_486"   data-external="true" rel="noopener noreferrer" >comparing_references_inspection</a> code sample adds a new inspection to the <span class="control" id="bd068086_487" >Java | Probable Bugs</span> group in the <a href="https://www.jetbrains.com/help/idea/inspections-settings.html" id="bd068086_488"   data-external="true" rel="noopener noreferrer" >Inspections List</a>.</p><p id="bd068086_489" >See <a href="code-samples.html" id="bd068086_490" data-tooltip="本指南包含了一些和 intellij-sdk-code-samples GitHub 仓库相关的插件示例代码."  >示例代码</a> on how to set up and run the plugin.</p><section class="chapter"  ><h3 id="configuring-the-plugin" data-toc="configuring-the-plugin"  >Configuring the Plugin</h3><p id="bd068086_491" >Once the plugin is launched, you can set the plugin options. You can specify the Java classes to participate in the code inspection and the severity level of the found probable bugs.</p><p id="bd068086_492" >On the main menu, open the  dialog. In the list of the IntelliJ IDEA <span class="control" id="bd068086_494" >Java</span> inspections, expand the <span class="control" id="bd068086_495" >Probable bugs</span> node, and then click <span class="control" id="bd068086_496" >SDK: '==' or '!=' instead of 'equals()'</span>.</p><figure  id="bd068086_497"><img alt="Comparing References inspection options" title="Comparing References inspection options" src="images/comparingReferences_options.png"  class="" width="349" height="119"/></figure><p id="bd068086_498" >Under <span class="control" id="bd068086_499" >Options</span>, you can specify the following plugin settings:</p><ul class="list _ul" id="bd068086_500"    ><li class="list__item" id="bd068086_501" ><p>From the <span class="control" id="bd068086_502" >Severity</span> list, select the severity level of probable bugs the plugin finds such as <span class="control" id="bd068086_503" >Warning</span>, <span class="control" id="bd068086_504" >Error</span>, etc.</p></li><li class="list__item" id="bd068086_505" ><p>In the text box under <span class="control" id="bd068086_506" >Severity</span>, specify the semicolon separated list of Java classes to participate in this code inspection.</p></li><li class="list__item" id="bd068086_507" ><p>When finished, click <span class="control" id="bd068086_508" >OK</span>.</p></li></ul></section><section class="chapter"  ><h3 id="how-does-it-work" data-toc="how-does-it-work"  >How does it work?</h3><p id="bd068086_509" >The plugin inspects your code opened in the IntelliJ IDEA editor. The plugin highlights the code fragments where two variables of the reference type are separated by <code class="code " id="bd068086_510"  >==</code> or <code class="code " id="bd068086_511"  >!=</code> and proposes to replace this code fragment with <code class="code " id="bd068086_512"  >.equals()</code>:</p><figure  id="bd068086_513"><img alt="Comparing References inspection highlighting and quick fix" title="Comparing References inspection highlighting and quick fix" src="images/comparingReferences.png"  class="" width="504" height="182"/></figure><p id="bd068086_514" >In this example, the <code class="code " id="bd068086_515"  >str1</code> and <code class="code " id="bd068086_516"  >str2</code> are variables of the String type. Invoking <span class="control" id="bd068086_517" >SDK: Use equals()</span> replaces:</p><div class="code-comparer" id="bd068086_518" data-comparing="vertically" ><div class="code-block" data-lang="java"    data-title="Before"     >
return (str1 == str2);
</div><div class="code-block" data-lang="java"    data-title="After"     >
return (str1.equals(str2));
</div></div></section></section><div class="last-modified"> Last modified: 29 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="syntax-errors.html">Syntax Errors</a>   <a class="navigation-links__next" href="controlling-highlighting.html">Controlling Highlighting</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>