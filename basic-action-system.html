<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-28T11:33:50.8298997"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>操作 | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"90175155_1","level":0,"title":"介绍","anchor":"#90175155_1"},{"id":"90175155_11","level":0,"title":"操作实现","anchor":"#90175155_11"},{"id":"registering-actions","level":0,"title":"Registering Actions","anchor":"#registering-actions"},{"id":"building-ui-from-actions","level":0,"title":"Building UI from Actions","anchor":"#building-ui-from-actions"},{"id":"useful-action-base-classes","level":0,"title":"Useful Action Base Classes","anchor":"#useful-action-base-classes"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="操作 | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/basic-action-system.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="操作 | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/basic-action-system.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/basic-action-system.html", "name": "操作 | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="basic_action_system.md" data-main-title="操作" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part II — Base Platform"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/basics/basic_action_system.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="basic_action_system.md" id="basic_action_system.md"  >操作</h1><section class="chapter"  ><h2 id="90175155_1" data-toc="90175155_1"  >介绍</h2><p id="90175155_2" >The actions system allows plugins to add their items to IntelliJ Platform-based IDE menus and toolbars. For example, one of the action classes is responsible for the  menu item and the <span class="control" id="90175155_4" >Open...</span> toolbar button.</p><p id="90175155_5" >Actions in the IntelliJ Platform require a <span id="90175155_6" >code implementation</span> and must be <a href="#registering-actions" id="90175155_7" data-tooltip="There are two main ways to register an action: either by listing it in the <actions> section of a plugin's plugin.xml file or through code."  >registered</a>. The action implementation determines the contexts in which an action is available, and its functionality when selected in the UI. Registration determines where an action appears in the IDE UI. Once implemented and registered, an action receives callbacks from the IntelliJ Platform in response to user gestures.</p><p id="90175155_8" >The <a href="working-with-custom-actions.html" id="90175155_9" data-tooltip="Plugins can add actions to existing IDE menus and toolbars, as well as add new menus and toolbars. The IntelliJ Platform calls the actions of plugins in response to user interactions with the IDE. However, the actions of a plugin must first be defined and registered with the…"  >Creating Actions</a> tutorial describes the process of adding a custom action to a plugin. The <a href="grouping-action.html" id="90175155_10" data-tooltip="If an implementation requires several actions, or there are simply too many actions that overload the menu, the actions can be placed into groups. This tutorial demonstrates adding an action to an existing group, creating a new action group, and action groups with a variable number…"  >Grouping Actions</a> tutorial demonstrates three types of groups that can contain actions.</p></section><section class="chapter"  ><h2 id="90175155_11" data-toc="90175155_11"  >操作实现</h2><p id="90175155_12" >An action is a class derived from the abstract class <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/AnAction.java" id="90175155_13"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_14"  >AnAction</code></a>. The IntelliJ Platform calls methods of actions when a user interacts with a menu item or toolbar button.</p><aside data-type="tip" class="prompt" data-title="" id="90175155_15" ><p id="90175155_16" >Classes based on <code class="code " id="90175155_17"  >AnAction</code> must not have class fields of any kind. This is because an instance of <code class="code " id="90175155_18"  >AnAction</code> class exists for the entire lifetime of the application. If the <code class="code " id="90175155_19"  >AnAction</code> class uses a field to store data that has a shorter lifetime and doesn't clear this data promptly, the data leaks. For example, any <code class="code " id="90175155_20"  >AnAction</code> data that exists only within the context of a <code class="code " id="90175155_21"  >Project</code> causes the <code class="code " id="90175155_22"  >Project</code> to be kept in memory after the user has closed it.</p></aside><section class="chapter"  ><h3 id="principal-implementation-overrides" data-toc="principal-implementation-overrides"  >Principal Implementation Overrides</h3><p id="90175155_23" >Every IntelliJ Platform action should override <code class="code " id="90175155_24"  >AnAction.update()</code> and must override <code class="code " id="90175155_25"  >AnAction.actionPerformed()</code>.</p><ul class="list _ul" id="90175155_26"    ><li class="list__item" id="90175155_27" ><p>An action's method <code class="code " id="90175155_28"  >AnAction.update()</code> is called by the IntelliJ Platform framework to update an action state. The state (enabled, visible) of an action determines whether the action is available in the UI. An object of the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/AnActionEvent.java" id="90175155_29"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_30"  >AnActionEvent</code></a> type is passed to this method and contains information about the current context for the action. Actions are made available by changing state in the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/Presentation.java" id="90175155_31"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_32"  >Presentation</code></a> object associated with the event context. As explained in <a href="#overriding-the-anactionupdate-method" id="90175155_33" data-tooltip="The method AnAction.update() is periodically called by the IntelliJ Platform in response to user gestures. The update() method gives an action to evaluate the current context and enable or disable its functionality. Implementors must ensure that changing presentation and…"  >Overriding the <code class="code " id="90175155_34"  >AnAction.update()</code> Method</a>, it is vital <code class="code " id="90175155_35"  >update()</code> methods <span class="emphasis" id="90175155_36" >execute quickly</span> and return execution to platform.</p></li><li class="list__item" id="90175155_37" ><p>An action's method <code class="code " id="90175155_38"  >AnAction.actionPerformed()</code> is called by the IntelliJ Platform if available and selected by the user. This method does the heavy lifting for the action: it contains the code executed when the action gets invoked. The <code class="code " id="90175155_39"  >actionPerformed()</code> method also receives <code class="code " id="90175155_40"  >AnActionEvent</code> as a parameter, which is used to access any context data like projects, files, selection, etc. See <a href="#overriding-the-anactionactionperformed-method" id="90175155_41" data-tooltip="When the user selects an enabled action, be it from a menu or toolbar, the action's AnAction.actionPerformed() method is called. This method contains the code executed to perform the action, and it is here that the real work gets done."  >Overriding the <code class="code " id="90175155_42"  >AnAction.actionPerformed()</code> Method</a> for more information.</p></li></ul><p id="90175155_43" >There are other methods to override in the <code class="code " id="90175155_44"  >AnAction</code> class, such as changing the default <code class="code " id="90175155_45"  >Presentation</code> object for the action. There is also a use case for overriding action constructors when registering them with dynamic action groups, demonstrated in the <a href="grouping-action.html#adding-child-actions-to-the-dynamic-group" id="90175155_46" data-tooltip="To add actions to the DynamicActionGroup, a non-empty array of AnAction instances should be returned from the DynamicActionGroup.getChildren() method. Here again, reuse the PopupDialogAction implementation. This use case is why PopupDialogAction overrides a constructor:"  >Grouping Actions</a> tutorial.</p></section><section class="chapter"  ><h3 id="overriding-the-anactionupdate-method" data-toc="overriding-the-anactionupdate-method"  >Overriding the AnAction.update Method</h3><p id="90175155_47" >The method <code class="code " id="90175155_48"  >AnAction.update()</code> is periodically called by the IntelliJ Platform in response to user gestures. The <code class="code " id="90175155_49"  >update()</code> method gives an action to evaluate the current context and enable or disable its functionality. Implementors must ensure that changing presentation and availability status handles all variants and state transitions; otherwise, the given Action will get &quot;stuck&quot;.</p><aside data-type="tip" class="prompt" data-title="" id="90175155_50" ><p id="90175155_51" >The <code class="code " id="90175155_52"  >AnAction.update()</code> method can be called frequently and on a UI thread. It must <span class="emphasis" id="90175155_53" >execute very quickly</span>; no real work must be performed. For example, checking selection in a tree or a list is considered valid, but working with the file system is not.</p></aside><aside data-type="tip" class="prompt" data-title="" id="90175155_54" ><p id="90175155_55" >If the new state of an action cannot be determined quickly, then evaluation should be performed in the <code class="code " id="90175155_56"  >AnAction.actionPerformed()</code> method, and <a href="notifications.html" id="90175155_57" data-tooltip="One of the leading design principles is avoiding the use of modal message boxes for notifying the user about errors and other situations that may warrant the user's attention. As a replacement, the IntelliJ Platform provides multiple non-modal notification UI options."  >notify</a> the user that the action cannot be executed if the context isn't suitable.</p></aside><section class="chapter"  ><h4 id="determining-the-action-context" data-toc="determining-the-action-context"  >Determining the Action Context</h4><p id="90175155_58" >The <code class="code " id="90175155_59"  >AnActionEvent</code> object passed to <code class="code " id="90175155_60"  >update()</code> carries information about the current context for the action. Context information is available from the methods of <code class="code " id="90175155_61"  >AnActionEvent</code>, providing information such as the Presentation and whether the action is triggered by a Toolbar. Additional context information is available using the method <code class="code " id="90175155_62"  >AnActionEvent.getData()</code>. Keys defined e.g. in <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/CommonDataKeys.java" id="90175155_63"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_64"  >CommonDataKeys</code></a> are passed to the <code class="code " id="90175155_65"  >getData()</code> method to retrieve objects such as <code class="code " id="90175155_66"  >Project</code>, <code class="code " id="90175155_67"  >Editor</code>, <code class="code " id="90175155_68"  >PsiFile</code>, and other information. Accessing this information is relatively light-weight and is suited for <code class="code " id="90175155_69"  >AnAction.update()</code>.</p></section><section class="chapter"  ><h4 id="enabling-and-setting-visibility-for-an-action" data-toc="enabling-and-setting-visibility-for-an-action"  >Enabling and Setting Visibility for an Action</h4><p id="90175155_70" >Based on information about the action context, the <code class="code " id="90175155_71"  >AnAction.update()</code> method can enable, disable, or hide an action. An action's enabled/disabled state and visibility are set using methods of the <code class="code " id="90175155_72"  >Presentation</code> object, which is accessed using <code class="code " id="90175155_73"  >AnActionEvent.getPresentation()</code>.</p><p id="90175155_74" >The default <code class="code " id="90175155_75"  >Presentation</code> object is a set of descriptive information about a menu or toolbar action. Every context for an action - it might appear in multiple menus, toolbars, or Navigation search locations - has a unique presentation. Attributes such as an action's text, description, and icons and visibility and enable/disable state, are stored in the presentation. The attributes in a presentation get initialized from the <a href="#registering-actions" id="90175155_76" data-tooltip="There are two main ways to register an action: either by listing it in the <actions> section of a plugin's plugin.xml file or through code."  >action registration</a>. However, some can be changed at runtime using the methods of the <code class="code " id="90175155_77"  >Presentation</code> object associated with an action.</p><p id="90175155_78" >The enabled/disabled state of an action is set using <code class="code " id="90175155_79"  >Presentation.setEnabled()</code>. The visibility state of an action is set using <code class="code " id="90175155_80"  >Presentation.setVisible()</code>. If an action is enabled, the <code class="code " id="90175155_81"  >AnAction.actionPerformed()</code> can be called if a user selects an action in the IDE. A menu action shows in the UI location specified in its registration. A toolbar action displays its enabled (or selected) icon, depending on the user interaction.</p><p id="90175155_82" >When an action is disabled <code class="code " id="90175155_83"  >AnAction.actionPerformed()</code> will not be called. Toolbar actions display their respective icons for the disabled state. The visibility of a disabled action in a menu depends on whether the host menu (e.g., &quot;ToolsMenu&quot;) containing the action has the <code class="code " id="90175155_84"  >compact</code> attribute set. See <a href="#grouping-actions" id="90175155_85" data-tooltip="Groups organize actions into logical UI structures, which in turn can contain other groups. A group of actions can form a toolbar or a menu. Subgroups of a group can form submenus of a menu."  >Grouping Actions</a> for more information about the <code class="code " id="90175155_86"  >compact</code> attribute and menu actions' visibility.</p><aside data-type="tip" class="prompt" data-title="" id="90175155_87" ><p id="90175155_88" >If an action is added to a toolbar, its <code class="code " id="90175155_89"  >update()</code> can be called if there was any user activity or focus transfer. If the action's availability changes in the absence of these events, then call <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/platform-api/src/com/intellij/ide/ActivityTracker.java" id="90175155_90"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_91"  >ActivityTracker.getInstance().inc()</code></a> to notify the action subsystem to update all toolbar actions.</p></aside><p id="90175155_92" >An example of enabling a menu action based on whether a project is open is demonstrated in <a href="https://github.com/JetBrains/intellij-sdk-code-samples/tree/main/action_basics/src/main/java/org/intellij/sdk/action/PopupDialogAction.java" id="90175155_93"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_94"  >PopupDialogAction.update()</code></a> method.</p></section></section><section class="chapter"  ><h3 id="overriding-the-anactionactionperformed-method" data-toc="overriding-the-anactionactionperformed-method"  >Overriding the AnAction.actionPerformed Method</h3><p id="90175155_95" >When the user selects an enabled action, be it from a menu or toolbar, the action's <code class="code " id="90175155_96"  >AnAction.actionPerformed()</code> method is called. This method contains the code executed to perform the action, and it is here that the real work gets done.</p><p id="90175155_97" >By using the <code class="code " id="90175155_98"  >AnActionEvent</code> methods and <code class="code " id="90175155_99"  >CommonDataKeys</code>, objects such as the <code class="code " id="90175155_100"  >Project</code>, <code class="code " id="90175155_101"  >Editor</code>, <code class="code " id="90175155_102"  >PsiFile</code>, and other information is available. For example, the <code class="code " id="90175155_103"  >actionPerformed()</code> method can modify, remove, or add PSI elements to a file open in the editor.</p><p id="90175155_104" >The code that executes in the <code class="code " id="90175155_105"  >AnAction.actionPerformed()</code> method should execute efficiently, but it does not have to meet the same stringent requirements as the <code class="code " id="90175155_106"  >update()</code> method.</p><p id="90175155_107" >An example of inspecting PSI elements is demonstrated in the SDK code sample <code class="code " id="90175155_108"  >action_basics</code> <a href="https://github.com/JetBrains/intellij-sdk-code-samples/tree/main/action_basics/src/main/java/org/intellij/sdk/action/PopupDialogAction.java" id="90175155_109"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_110"  >PopupDialogAction.actionPerformed()</code></a> method.</p></section><section class="chapter"  ><h3 id="action-ids" data-toc="action-ids"  >Action IDs</h3><p id="90175155_111" >Every action and action group has a unique identifier. Basing the identifier for a custom action on the fully qualified name of the implementation is the best practice, assuming the package incorporates the <a href="plugin-configuration-file.html#idea-plugin__id" id="90175155_112" data-tooltip="A unique identifier of the plugin. It should be a fully qualified name similar to Java packages and must not collide with the ID of existing plugins. The ID is a technical value used to identify the plugin in the IDE and JetBrains Marketplace."  ><code class="code " id="90175155_113"  >&lt;id&gt;</code></a> of the plugin. Including the plugin identifier in the action identifier should prevent it from clashing with other plugins' actions. An action must have a unique identifier for each place. It is used in the IDE UI, even though the FQN of the implementation is the same. Definitions of identifiers for the standard IntelliJ Platform actions are in <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/ide-core/src/com/intellij/openapi/actionSystem/IdeActions.java" id="90175155_114"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_115"  >IdeActions</code></a>.</p></section><section class="chapter"  ><h3 id="grouping-actions" data-toc="grouping-actions"  >Grouping Actions</h3><p id="90175155_116" >Groups organize actions into logical UI structures, which in turn can contain other groups. A group of actions can form a toolbar or a menu. Subgroups of a group can form submenus of a menu.</p><p id="90175155_117" >Actions can be included in multiple groups, and thus appear in different places within the UI. An action must have a unique identifier for each place it appears in the UI. See the <a href="#action-declaration-reference" id="90175155_118" data-tooltip="The places where actions can appear are defined by constants in ActionPlaces. Group IDs for the IntelliJ Platform are defined in PlatformActions.xml."  >Action Declaration Reference</a> section for information about how to specify locations.</p><section class="chapter"  ><h4 id="presentation" data-toc="presentation"  >Presentation</h4><p id="90175155_119" >A new <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/Presentation.java" id="90175155_120"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_121"  >Presentation</code></a> gets created for every place where the action appears. Therefore, the same action can have a different text or icon when it appears in different places of the user interface. Different presentations for the action are created by copying the Presentation returned by the <code class="code " id="90175155_122"  >AnAction.getTemplatePresentation()</code> method.</p></section><section class="chapter"  ><h4 id="compact-attribute" data-toc="compact-attribute"  >Compact Attribute</h4><p id="90175155_123" >A group's <code class="code " id="90175155_124"  >compact</code> attribute specifies whether an action within that group is visible when disabled. See <a href="#registering-actions-in-pluginxml" id="90175155_125" data-tooltip="Registering actions in plugin.xml is demonstrated in the following reference examples, which document all elements and attributes used in the <actions> section and describe each element's meaning."  >Registering Actions in plugin.xml</a> for an explanation of how the <code class="code " id="90175155_126"  >compact</code> attribute is set for a group. If the <code class="code " id="90175155_127"  >compact</code> attribute is <code class="code " id="90175155_128"  >true</code> for a menu group, an action in the menu only appears if its state is both enabled and visible. In contrast, if the <code class="code " id="90175155_129"  >compact</code> attribute is <code class="code " id="90175155_130"  >false</code>, an action in the menu appears if its state is disabled but visible. Some menus like  have the <code class="code " id="90175155_132"  >compact</code> attribute set, so there isn't a way to show an action on the  menu if it is not enabled.</p><div class="table-wrapper" ><table class=" wide" id="90175155_134"  ><thead><tr class=" ijRowHead" id="90175155_135" ><th id="90175155_136"    ><p>Host Menu</p><p><code class="code " id="90175155_138"  >compact</code> Setting</p></th><th id="90175155_139"    ><p>Action Enabled</p></th><th id="90175155_140"    ><p>Visibility Enabled</p></th><th id="90175155_141"    ><p>Menu Item Visible?</p></th><th id="90175155_142"    ><p>Menu Item Appears Gray?</p></th></tr></thead><tbody ><tr class="" id="90175155_143" ><td id="90175155_144"    ><p>T</p></td><td id="90175155_145"    ><p><span class="control" id="90175155_146" >F</span></p></td><td id="90175155_147"    ><p>T</p></td><td id="90175155_148"    ><p><span class="control" id="90175155_149" >F</span></p></td><td id="90175155_150"    ><p>N/A</p></td></tr><tr class="" id="90175155_151" ><td id="90175155_152"    ><p>T</p></td><td id="90175155_153"    ><p>T</p></td><td id="90175155_154"    ><p>T</p></td><td id="90175155_155"    ><p>T</p></td><td id="90175155_156"    ><p>F</p></td></tr><tr class="" id="90175155_157" ><td id="90175155_158"    ><p>F</p></td><td id="90175155_159"    ><p><span class="control" id="90175155_160" >F</span></p></td><td id="90175155_161"    ><p>T</p></td><td id="90175155_162"    ><p><span class="control" id="90175155_163" >T</span></p></td><td id="90175155_164"    ><p><span class="control" id="90175155_165" >T</span></p></td></tr><tr class="" id="90175155_166" ><td id="90175155_167"    ><p>F</p></td><td id="90175155_168"    ><p>T</p></td><td id="90175155_169"    ><p>T</p></td><td id="90175155_170"    ><p>T</p></td><td id="90175155_171"    ><p>F</p></td></tr></tbody ></table ></div><p id="90175155_172" >All other combinations of <code class="code " id="90175155_173"  >compact</code>, visibility, and enablement produce N/A for gray appearance because the menu item isn't visible.</p><p id="90175155_174" >See the <a href="grouping-action.html" id="90175155_175" data-tooltip="If an implementation requires several actions, or there are simply too many actions that overload the menu, the actions can be placed into groups. This tutorial demonstrates adding an action to an existing group, creating a new action group, and action groups with a variable number…"  >Grouping Actions</a> tutorial for examples of creating action groups.</p></section></section></section><section class="chapter"  ><h2 id="registering-actions" data-toc="registering-actions"  >Registering Actions</h2><p id="90175155_176" >There are two main ways to register an action: either by listing it in the <a href="plugin-configuration-file.html#idea-plugin__actions" id="90175155_177" data-tooltip="Defines the plugin actions."  ><code class="code " id="90175155_178"  >&lt;actions&gt;</code></a> section of a plugin's <span class="filepath" id="90175155_179" ><a href="plugin-configuration-file.html" id="90175155_180" data-tooltip="Plugin configuration file contains all the information about the plugin, as well as all registered extensions, actions, listeners, etc."  >plugin.xml</a></span> file or through code.</p><section class="chapter"  ><h3 id="registering-actions-in-pluginxml" data-toc="registering-actions-in-pluginxml"  >Registering Actions in plugin.xml</h3><p id="90175155_181" >Registering actions in <span class="filepath" id="90175155_182" >plugin.xml</span> is demonstrated in the following reference examples, which document all elements and attributes used in the <a href="plugin-configuration-file.html#idea-plugin__actions" id="90175155_183" data-tooltip="Defines the plugin actions."  ><code class="code " id="90175155_184"  >&lt;actions&gt;</code></a> section and describe each element's meaning.</p><section class="chapter"  ><h4 id="setting-the-override-text-element" data-toc="setting-the-override-text-element"  >Setting the Override-Text Element</h4><p id="90175155_185" >Beginning in 2020.1, an alternate version of an action's menu text can be declared for use depending on where an action appears. Using the <a href="plugin-configuration-file.html#idea-plugin__actions__action__override-text" id="90175155_186" data-tooltip="Defines an alternate version of the text for the menu action or group."  ><code class="code " id="90175155_187"  >&lt;override-text&gt;</code></a> element, the menu text for an action can be different depending on context: menu location, toolbar, etc. This is also available for groups in 2020.3 and later.</p><p id="90175155_188" >In the <code class="code " id="90175155_189"  >&lt;action&gt;</code> element reference example (below) with <code class="code " id="90175155_190"  >id</code> attribute <code class="code " id="90175155_191"  >VssIntegration.GarbageCollection</code>, the default is to use the menu text &quot;Garbage Collector: Collect _Garbage.&quot; The <code class="code " id="90175155_192"  >&lt;add-to-group&gt;</code> element declares the action is added to the  menu.</p><p id="90175155_194" >However, the <code class="code " id="90175155_195"  >&lt;override-text&gt;</code> element declares that text for <code class="code " id="90175155_196"  >VssIntegration.GarbageCollection</code> displayed anywhere in the main menu system should be the alternate text &quot;Collect _Garbage.&quot; The  menu is part of the main menu, so the displayed menu text is &quot;Collect _Garbage.&quot; A different context, such as searching for the action using , displays the default text &quot;Garbage Collector: Collect _Garbage&quot; to give the user additional information about the action.</p><p id="90175155_199" >A second <code class="code " id="90175155_200"  >&lt;override-text&gt;</code> element uses <code class="code " id="90175155_201"  >place</code> and <code class="code " id="90175155_202"  >use-text-of-place</code> attributes to declare the same version of the text used in the main menu is also used in the editor popup menu. Additional <code class="code " id="90175155_203"  >&lt;override-text&gt;</code> elements could be used to specify other places where the main menu text should be used.</p><p id="90175155_204" >An example of using <code class="code " id="90175155_205"  >&lt;override-text&gt;</code> is demonstrated in the <a href="working-with-custom-actions.html#using-override-text-for-an-action" id="90175155_206" data-tooltip="By using the override-text element introduced in 2020.1 of the IntelliJ Platform, the action text can be different depending on the context of where the action appears: menu, toolbar, etc. The example above uses this element to ensure the shorter text "Popup Dialog Action" is shown…"  >Creating Actions</a> tutorial.</p></section><section class="chapter"  ><h4 id="setting-the-synonym-element" data-toc="setting-the-synonym-element"  >Setting the Synonym Element</h4><p id="90175155_207" ><span class="emphasis" id="90175155_208" >2020.3</span> Users can locate actions via their name by invoking .</p><p id="90175155_210" >To allow using alternative names in search, add one or more <a href="plugin-configuration-file.html#idea-plugin__actions__action__synonym" id="90175155_211" data-tooltip="Defines an alternative name for searching the action by name. A single action can have multiple synonyms."  ><code class="code " id="90175155_212"  >&lt;synonym&gt;</code></a> elements inside <a href="plugin-configuration-file.html#idea-plugin__actions__action" id="90175155_213" data-tooltip="A single action entry of the <actions> implemented by the plugin. A single <actions> element can contain multiple <action> elements."  ><code class="code " id="90175155_214"  >&lt;action&gt;</code></a> or <a href="plugin-configuration-file.html#idea-plugin__actions__reference" id="90175155_215" data-tooltip="Allows adding an existing action to the group. The element can be used directly under the <actions> element, or in the <group> element."  ><code class="code " id="90175155_216"  >&lt;reference&gt;</code></a>:</p><div class="code-block" data-lang="markup"         >
&lt;action id=&quot;MyAction&quot; text=&quot;My Action Name&quot; ...&gt;
  &lt;synonym text=&quot;Another Search Term&quot;/&gt;
&lt;/action&gt;
</div><p id="90175155_218" >To provide a localized synonym, specify <code class="code " id="90175155_219"  >key</code> instead of <code class="code " id="90175155_220"  >text</code> attribute.</p></section><section class="chapter"  ><h4 id="disabling-search-for-group" data-toc="disabling-search-for-group"  >Disabling Search for Group</h4><p id="90175155_221" ><span class="emphasis" id="90175155_222" >2020.3</span> To exclude a group from appearing in  results (e.g., <span class="control" id="90175155_224" >New...</span> popup), specify <code class="code " id="90175155_225"  >searchable=&quot;false&quot;</code>.</p></section><section class="chapter"  ><h4 id="localizing-actions-and-groups" data-toc="localizing-actions-and-groups"  >Localizing Actions and Groups</h4><p id="90175155_226" >Action and group localization use resource bundles containing property files named <span class="filepath" id="90175155_227" >$NAME$Bundle.properties</span>, each file consisting of <code class="code " id="90175155_228"  >key=value</code> pairs. The <a href="https://github.com/JetBrains/intellij-sdk-code-samples/tree/main/action_basics" id="90175155_229"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_230"  >action_basics</code></a> plugin demonstrates using a resource bundle to localize the group and action entries added to the Editor Popup Menu.</p><p id="90175155_231" >When localizing actions and groups, the <code class="code " id="90175155_232"  >text</code> and <code class="code " id="90175155_233"  >description</code> attributes are not declared in <span class="filepath" id="90175155_234" >plugin.xml</span>. Instead, those attribute values vary depending on the locale and get declared in a resource bundle.</p><p id="90175155_235" >The name and location of the resource bundle must be declared in the <span class="filepath" id="90175155_236" >plugin.xml</span> file. In the case of <code class="code " id="90175155_237"  >action_basics</code>, only a default localization resource bundle (<span class="filepath" id="90175155_238" >/resources/messages/BasicActionsBundle.properties</span>) is provided:</p><div class="code-block" data-lang="markup"         >
&lt;resource-bundle&gt;messages.BasicActionsBundle&lt;/resource-bundle&gt;
</div><p id="90175155_240" ><span class="emphasis" id="90175155_241" >2020.1</span> If necessary, a dedicated resource bundle to use for actions and groups can be defined on <a href="plugin-configuration-file.html#idea-plugin__actions" id="90175155_242" data-tooltip="Defines the plugin actions."  ><code class="code " id="90175155_243"  >&lt;actions&gt;</code></a>:</p><div class="code-block" data-lang="markup"         >
&lt;actions resource-bundle=&quot;messages.MyActionsBundle&quot;&gt;
  &lt;!-- action/group defined here will use keys from MyActionsBundle.properties --&gt;
&lt;/actions&gt;
</div><p id="90175155_245" >See <a href="grouping-action.html#extending-defaultactiongroup" id="90175155_246" data-tooltip="The DefaultActionGroup is an implementation of ActionGroup. The DefaultActionGroup class is used to add child actions and separators between them to a group. This class is used if a set of actions belonging to the group does not change at runtime."  >Extending DefaultActionGroup</a> for a tutorial of localizing Actions and Groups.</p><div class="tabs" id="90175155_247"><div class="tabs__content" data-gtm="tab" id="90175155_248"   data-title="Actions" ><p id="90175155_249" >For Actions, the key in property files incorporates the action <code class="code " id="90175155_250"  >id</code> in this specific structure:</p><ul class="list _ul" id="90175155_251"    ><li class="list__item" id="90175155_252" ><p><code class="code " id="90175155_253"  >action.&lt;action-id&gt;.text=Translated Action Text</code></p></li><li class="list__item" id="90175155_254" ><p><code class="code " id="90175155_255"  >action.&lt;action-id&gt;.description=Translated Action Description</code></p></li></ul><p id="90175155_256" ><span class="emphasis" id="90175155_257" >2020.1</span> If <code class="code " id="90175155_258"  >&lt;override-text&gt;</code> is used for an action <code class="code " id="90175155_259"  >id</code>, the key includes the <code class="code " id="90175155_260"  >place</code> attribute:</p><ul class="list _ul" id="90175155_261"    ><li class="list__item" id="90175155_262" ><p><code class="code " id="90175155_263"  >action.&lt;action-id&gt;.&lt;place&gt;.text=Place-dependent Translated Action Text</code></p></li></ul></div><div class="tabs__content" data-gtm="tab" id="90175155_264"   data-title="Groups" ><p id="90175155_265" >For Groups, the <code class="code " id="90175155_266"  >key</code> in the property files incorporates the group <code class="code " id="90175155_267"  >id</code> in this specific structure:</p><ul class="list _ul" id="90175155_268"    ><li class="list__item" id="90175155_269" ><p><code class="code " id="90175155_270"  >group.&lt;group-id&gt;.text=Translated Group Text</code></p></li><li class="list__item" id="90175155_271" ><p><code class="code " id="90175155_272"  >group.&lt;group-id&gt;.description=Translated Group Description</code></p></li></ul><p id="90175155_273" ><span class="emphasis" id="90175155_274" >2020.3</span> If <code class="code " id="90175155_275"  >&lt;override-text&gt;</code> is used for a group <code class="code " id="90175155_276"  >id</code>, the key includes the <code class="code " id="90175155_277"  >&lt;place&gt;</code> attribute:</p><ul class="list _ul" id="90175155_278"    ><li class="list__item" id="90175155_279" ><p><code class="code " id="90175155_280"  >group.&lt;group-id&gt;.&lt;place&gt;.text=Place-dependent Translated Group Text</code></p></li></ul></div></div></section><section class="chapter"  ><h4 id="action-declaration-reference" data-toc="action-declaration-reference"  >Action Declaration Reference</h4><p id="90175155_281" >The places where actions can appear are defined by constants in <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/ide-core/src/com/intellij/openapi/actionSystem/ActionPlaces.java" id="90175155_282"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_283"  >ActionPlaces</code></a>. Group IDs for the IntelliJ Platform are defined in <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/platform-resources/src/idea/PlatformActions.xml" id="90175155_284"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_285"  >PlatformActions.xml</code></a>.</p><p id="90175155_286" >This, and additional information can also be found by using the <a href="https://www.jetbrains.com/help/idea/auto-completing-code.html#invoke-basic-completion" id="90175155_287"   data-external="true" rel="noopener noreferrer" >Code Completion</a>, <a href="https://www.jetbrains.com/help/idea/viewing-reference-information.html#view-definition-symbols" id="90175155_288"   data-external="true" rel="noopener noreferrer" >Quick Definition</a> and <a href="https://www.jetbrains.com/help/idea/viewing-reference-information.html#inline-quick-documentation" id="90175155_289"   data-external="true" rel="noopener noreferrer" >Quick Documentation</a> features.</p><aside data-type="tip" class="prompt" data-title="" id="90175155_290" ><p id="90175155_291" >To lookup existing Action ID (e.g. for use in <code class="code " id="90175155_292"  >relative-to-action</code>), <a href="internal-ui-inspector.html" id="90175155_293" data-tooltip="UI 检查器 工具可以用来检测IntelliJ IDEA界面来获取每个元素的内部描述. UI 检查器 启用时, UI 元素可以通过交互式点击来测试."  >UI Inspector</a> can be used.</p></aside><aside data-type="tip" class="prompt" data-title="" id="90175155_294" ><p id="90175155_295" >See the <a href="plugin-configuration-file.html#idea-plugin__actions" id="90175155_296" data-tooltip="Defines the plugin actions."  ><code class="code " id="90175155_297"  >&lt;actions&gt;</code></a> element and its children documentation for details.</p></aside><div class="code-block" data-lang="markup"         >
&lt;actions&gt;

  &lt;action
      id=&quot;VssIntegration.GarbageCollection&quot;
      class=&quot;com.example.impl.CollectGarbage&quot;
      text=&quot;Garbage Collector: Collect _Garbage&quot;
      description=&quot;Run garbage collector&quot;
      icon=&quot;icons/garbage.png&quot;&gt;

    &lt;!--
    The second &lt;override-text&gt; element uses the alternate attribute
    &quot;use-text-of-place&quot; to define a location (EditorPopup) to use the
    same text as is used in MainMenu. It is a way to specify the use
    of an alternate menu text in multiple discrete menu groups.
    --&gt;
    &lt;override-text place=&quot;MainMenu&quot; text=&quot;Collect _Garbage&quot;/&gt;
    &lt;override-text place=&quot;EditorPopup&quot; use-text-of-place=&quot;MainMenu&quot;/&gt;

    &lt;!-- Provide alternative names for searching action by name --&gt;
    &lt;synonym text=&quot;GC&quot;/&gt;

    &lt;add-to-group
        group-id=&quot;ToolsMenu&quot;
        relative-to-action=&quot;GenerateJavadoc&quot;
        anchor=&quot;after&quot;/&gt;

    &lt;!-- Add the first and second keystrokes to all keymaps... --&gt;
    &lt;keyboard-shortcut
        keymap=&quot;$default&quot;
        first-keystroke=&quot;control alt G&quot;
        second-keystroke=&quot;C&quot;/&gt;

    &lt;!-- ...except the &quot;Mac OS X&quot; keymap and its children. --&gt;
    &lt;keyboard-shortcut
        keymap=&quot;Mac OS X&quot;
        first-keystroke=&quot;control alt G&quot;
        second-keystroke=&quot;C&quot;
        remove=&quot;true&quot;/&gt;

    &lt;!-- The &quot;Mac OS X 10.5+&quot; keymap and its children will have only
    this keyboard shortcut for this action. --&gt;
    &lt;keyboard-shortcut
        keymap=&quot;Mac OS X 10.5+&quot;
        first-keystroke=&quot;control alt G&quot;
        second-keystroke=&quot;C&quot;
        replace-all=&quot;true&quot;/&gt;

    &lt;mouse-shortcut
        keymap=&quot;$default&quot;
        keystroke=&quot;control button3 doubleClick&quot;/&gt;
  &lt;/action&gt;

  &lt;!--
  This action declares neither a text nor a description attribute.
  If it has a resource bundle declared, the text and descriptions
  will be retrieved based on the action-id incorporated in the key
  for a translated string.
  --&gt;
  &lt;action
      id=&quot;sdk.action.PopupDialogAction&quot;
      class=&quot;sdk.action.PopupDialogAction&quot;
      icon=&quot;SdkIcons.Sdk_default_icon&quot;/&gt;

  &lt;group
      class=&quot;com.example.impl.MyActionGroup&quot;
      id=&quot;TestActionGroup&quot;
      text=&quot;Test Group&quot;
      description=&quot;Group with test actions&quot;
      icon=&quot;icons/testgroup.png&quot;
      popup=&quot;true&quot;
      compact=&quot;true&quot;&gt;

    &lt;action
        id=&quot;VssIntegration.TestAction&quot;
        class=&quot;com.example.impl.TestAction&quot;
        text=&quot;My Test Action&quot;
        description=&quot;My test action&quot;/&gt;

    &lt;!-- The &lt;separator&gt; element defines a separator between actions.
    It can also have an &lt;add-to-group&gt; child element. --&gt;
    &lt;separator/&gt;

    &lt;group id=&quot;TestActionSubGroup&quot;/&gt;

    &lt;!-- The &lt;reference&gt; element allows adding an existing action to
    the group. The mandatory &quot;ref&quot; attribute specifies the ID of
    the action to add. --&gt;
    &lt;reference ref=&quot;EditorCopy&quot;/&gt;

    &lt;add-to-group
        group-id=&quot;MainMenu&quot;
        relative-to-action=&quot;HelpMenu&quot;
        anchor=&quot;before&quot;/&gt;
  &lt;/group&gt;
&lt;/actions&gt;
</div></section></section><section class="chapter"  ><h3 id="registering-actions-from-code" data-toc="registering-actions-from-code"  >Registering Actions from Code</h3><p id="90175155_299" >Two steps are required to register an action from code:</p><ul class="list _ul" id="90175155_300"    ><li class="list__item" id="90175155_301" ><p>First, an instance of the class derived from <code class="code " id="90175155_302"  >AnAction</code> must be passed to the <code class="code " id="90175155_303"  >registerAction()</code> method of <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/ActionManager.java" id="90175155_304"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_305"  >ActionManager</code></a>, to associate the action with an ID.</p></li><li class="list__item" id="90175155_306" ><p>Second, the action needs to be added to one or more groups. To get an instance of an action group by ID, it is necessary to call <code class="code " id="90175155_307"  >ActionManager.getAction()</code> and cast the returned value to <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/platform-api/src/com/intellij/openapi/actionSystem/DefaultActionGroup.java" id="90175155_308"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_309"  >DefaultActionGroup</code></a>.</p></li></ul></section></section><section class="chapter"  ><h2 id="building-ui-from-actions" data-toc="building-ui-from-actions"  >Building UI from Actions</h2><p id="90175155_310" >If a plugin needs to include a toolbar or popup menu built from a group of actions in its user interface, that is accomplished through <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/ActionPopupMenu.java" id="90175155_311"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_312"  >ActionPopupMenu</code></a> and <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/editor-ui-api/src/com/intellij/openapi/actionSystem/ActionToolbar.java" id="90175155_313"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_314"  >ActionToolbar</code></a>. These objects can be created through calls to the <code class="code " id="90175155_315"  >ActionManager.createActionPopupMenu()</code> and <code class="code " id="90175155_316"  >createActionToolbar()</code> methods. To get a Swing component from such an object, call the respective <code class="code " id="90175155_317"  >getComponent()</code> method.</p><p id="90175155_318" >If an action toolbar is attached to a specific component (for example, a panel in a tool window), call <code class="code " id="90175155_319"  >ActionToolbar.setTargetComponent()</code> and pass the related component's instance as a parameter. Setting the target ensures that the toolbar buttons' state depends on the state of the related component, not on the current focus location within the IDE frame.</p><p id="90175155_320" >See <a href="https://jetbrains.design/intellij/controls/toolbar/" id="90175155_321"   data-external="true" rel="noopener noreferrer" >Toolbar</a> in IntelliJ Platform UI Guidelines for an overview.</p></section><section class="chapter"  ><h2 id="useful-action-base-classes" data-toc="useful-action-base-classes"  >Useful Action Base Classes</h2><section class="chapter"  ><h3 id="toggleselection" data-toc="toggleselection"  >Toggle/Selection</h3><p id="90175155_322" >Use <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/platform-api/src/com/intellij/openapi/actionSystem/ToggleAction.java" id="90175155_323"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_324"  >ToggleAction</code></a> for actions with &quot;selected&quot;/&quot;pressed&quot; state (e.g., menu item with checkbox, toolbar action button). See also <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/platform-api/src/com/intellij/openapi/actionSystem/ToggleOptionAction.java" id="90175155_325"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_326"  >ToggleOptionAction</code></a>.</p></section><section class="chapter"  ><h3 id="backforward-navigation" data-toc="backforward-navigation"  >Back/Forward Navigation</h3><p id="90175155_327" >Use <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/platform-api/src/com/intellij/ui/navigation/BackAction.java" id="90175155_328"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_329"  >BackAction</code></a> and <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/platform-api/src/com/intellij/ui/navigation/ForwardAction.java" id="90175155_330"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_331"  >ForwardAction</code></a> to provide navigation trail taken from <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/platform-api/src/com/intellij/ui/navigation/History.java" id="90175155_332"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_333"  >History</code></a> provided by <code class="code " id="90175155_334"  >History.KEY</code>.</p></section><section class="chapter"  ><h3 id="runtime-placeholder-action" data-toc="runtime-placeholder-action"  >Runtime Placeholder Action</h3><p id="90175155_335" >For actions registered at runtime (e.g., in a tool window toolbar), add an <a href="plugin-configuration-file.html#idea-plugin__actions__action" id="90175155_336" data-tooltip="A single action entry of the <actions> implemented by the plugin. A single <actions> element can contain multiple <action> elements."  ><code class="code " id="90175155_337"  >&lt;action&gt;</code></a> entry with <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/platform-api/src/com/intellij/openapi/actionSystem/EmptyAction.java" id="90175155_338"   data-external="true" rel="noopener noreferrer" ><code class="code " id="90175155_339"  >EmptyAction</code></a> to &quot;reserve&quot; Action ID so they become visible in .</p></section></section><div class="last-modified"> Last modified: 28 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="themes-metadata.html">Exposing Theme Metadata</a>   <a class="navigation-links__next" href="action-system.html">Actions Tutorial</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>