<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-25T22:17:41.2946565"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>Run Configuration Management | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"configuration-type","level":0,"title":"Configuration Type","anchor":"#configuration-type"},{"id":"configuration-factory","level":0,"title":"Configuration Factory","anchor":"#configuration-factory"},{"id":"run-configuration","level":0,"title":"Run Configuration","anchor":"#run-configuration"},{"id":"settings-editor","level":0,"title":"Settings Editor","anchor":"#settings-editor"},{"id":"persistence","level":0,"title":"Persistence","anchor":"#persistence"},{"id":"refactoring-support","level":0,"title":"Refactoring Support","anchor":"#refactoring-support"},{"id":"creating-configurations-from-context","level":0,"title":"Creating Configurations from Context","anchor":"#creating-configurations-from-context"},{"id":"running-from-the-gutter","level":0,"title":"Running from the Gutter","anchor":"#running-from-the-gutter"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Run Configuration Management | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/run-configuration-management.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="Run Configuration Management | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/run-configuration-management.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/run-configuration-management.html", "name": "Run Configuration Management | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="run_configuration_management.md" data-main-title="Run Configuration Management" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part II — Base Platform///basic_run_configurations.md|Run Configurations"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/basics/run_configurations/run_configuration_management.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="run_configuration_management.md" id="run_configuration_management.md"  >Run Configuration Management</h1><p id="5ea0286b_1" >This document describes the primary classes to work with run configurations and everyday use cases.</p><section class="chapter"  ><h2 id="configuration-type" data-toc="configuration-type"  >Configuration Type</h2><p id="5ea0286b_2" >The starting point for implementing any run configuration type is the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/ConfigurationType.java" id="5ea0286b_3"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_4"  >ConfigurationType</code></a> interface. The list of available configuration types is shown when a user opens the <span class="emphasis" id="5ea0286b_5" >'Edit run configurations'</span> dialog and executes <span class="emphasis" id="5ea0286b_6" >'Add'</span> action:</p><figure  id="5ea0286b_7"><img alt="Create" title="Create" src="images/create-1.png"  class="" width="618" height="722"/></figure><p id="5ea0286b_8" >Every type there is represented as an instance of <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/ConfigurationType.java" id="5ea0286b_9"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_10"  >ConfigurationType</code></a> and registered like below:</p><div class="code-block" data-lang="markup"         >
&lt;configurationType
    implementation=&quot;org.jetbrains.plugins.gradle.service.execution.GradleExternalTaskConfigurationType&quot;/&gt;
</div><p id="5ea0286b_12" >The easiest way to implement this interface is to use the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/runConfigurationType.kt" id="5ea0286b_13"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_14"  >ConfigurationTypeBase</code></a> base class. To use it, you need to inherit from it and to provide the configuration type parameters (ID, name, description, and icon) as constructor parameters. In addition to that, you need to call the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/runConfigurationType.kt" id="5ea0286b_15"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_16"  >addFactory()</code></a> method to add a configuration factory.</p></section><section class="chapter"  ><h2 id="configuration-factory" data-toc="configuration-factory"  >Configuration Factory</h2><p id="5ea0286b_17" >All run configurations are created by the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/ConfigurationFactory.java" id="5ea0286b_18"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_19"  >ConfigurationFactory</code></a> registered for a particular <code class="code " id="5ea0286b_20"  >ConfigurationType</code>. It's possible that one <code class="code " id="5ea0286b_21"  >ConfigurationType</code> has more than one <code class="code " id="5ea0286b_22"  >ConfigurationFactory</code>:</p><figure  id="5ea0286b_23"><img alt="Configuration Factory" title="Configuration Factory" src="images/create-3.png"  class="" width="1062" height="715"/></figure><p id="5ea0286b_24" >The key API of <code class="code " id="5ea0286b_25"  >ConfigurationFactory</code>, and the only method that you're required to implement, is the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/ConfigurationFactory.java" id="5ea0286b_26"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_27"  >createTemplateConfiguration</code></a> method. This method is called once per project to create the template run configuration.</p><p id="5ea0286b_28" >All real run configurations (loaded from the workspace or created by the user) are called by cloning the template through the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/ConfigurationFactory.java" id="5ea0286b_29"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_30"  >createConfiguration</code></a> method.</p><p id="5ea0286b_31" >You can customize additional aspects of your configuration factory by overriding the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/ConfigurationFactory.java" id="5ea0286b_32"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_33"  >getIcon</code></a>, <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/ConfigurationFactory.java" id="5ea0286b_34"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_35"  >getAddIcon</code></a>, <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/ConfigurationFactory.java" id="5ea0286b_36"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_37"  >getName</code></a> and the default settings methods. These additional overrides are optional.</p></section><section class="chapter"  ><h2 id="run-configuration" data-toc="run-configuration"  >Run Configuration</h2><p id="5ea0286b_38" >The run configuration itself is represented by the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/RunConfiguration.java" id="5ea0286b_39"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_40"  >RunConfiguration</code></a> interface. A <span class="emphasis" id="5ea0286b_41" >'run configuration'</span> here is some named profile which can be executed, e.g., the application started via <code class="code " id="5ea0286b_42"  >main()</code> class, test, remote debug to particular machine/port, etc.</p><p id="5ea0286b_43" >Here is an example of a Java run configuration defined for a particular project:</p><figure  id="5ea0286b_44"><img alt="Run Configuration" title="Run Configuration" src="images/create-2.png"  class="" width="1052" height="710"/></figure><p id="5ea0286b_45" >When implementing a run configuration, you may want to use one of the common base classes:</p><ul class="list _ul" id="5ea0286b_46"    ><li class="list__item" id="5ea0286b_47" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/RunConfigurationBase.java" id="5ea0286b_48"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_49"  >RunConfigurationBase</code></a> is a general-purpose superclass that contains the most basic implementation of a run configuration.</p></li><li class="list__item" id="5ea0286b_50" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/LocatableConfigurationBase.java" id="5ea0286b_51"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_52"  >LocatableConfigurationBase</code></a> is a common base class that should be used for configurations that can be created from context by a <code class="code " id="5ea0286b_53"  >RunConfigurationProducer</code>. It supports automatically generating a name for a configuration from its settings and keeping track of whether the name was changed by the user.</p></li><li class="list__item" id="5ea0286b_54" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/ModuleBasedConfiguration.java" id="5ea0286b_55"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_56"  >ModuleBasedConfiguration</code></a> is a base class for a configuration that is associated with a specific module (for example, Java run configurations use the selected module to determine the run classpath).</p></li></ul></section><section class="chapter"  ><h2 id="settings-editor" data-toc="settings-editor"  >Settings Editor</h2><p id="5ea0286b_57" >That common run configuration settings might be modified via:</p><p id="5ea0286b_58" ><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/RunConfiguration.java" id="5ea0286b_59"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_60"  >RunConfiguration</code>-specific UI</a> That is handled by <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/ide-core/src/com/intellij/openapi/options/SettingsEditor.java" id="5ea0286b_61"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_62"  >SettingsEditor</code></a>:</p><ul class="list _ul" id="5ea0286b_63"    ><li class="list__item" id="5ea0286b_64" ><p><code class="code " id="5ea0286b_65"  >getComponent()</code> method is called by the IDE and shows run configuration specific UI.</p></li><li class="list__item" id="5ea0286b_66" ><p><code class="code " id="5ea0286b_67"  >resetFrom()</code> is called to discard all non-confirmed user changes made via that UI.</p></li><li class="list__item" id="5ea0286b_68" ><p><code class="code " id="5ea0286b_69"  >applyTo()</code> is called to confirm the changes, i.e. copy current UI state into the target settings object.</p></li></ul></section><section class="chapter"  ><h2 id="persistence" data-toc="persistence"  >Persistence</h2><p id="5ea0286b_70" >That run configuration settings are persistent, i.e., they are stored at the file system and loaded back on the IDE startup. That is performed via <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/util/src/com/intellij/openapi/util/JDOMExternalizable.java" id="5ea0286b_71"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_72"  >writeExternal()</code></a> and <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/util/src/com/intellij/openapi/util/JDOMExternalizable.java" id="5ea0286b_73"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_74"  >readExternal()</code></a> methods of <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/RunConfiguration.java" id="5ea0286b_75"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_76"  >RunConfiguration</code></a> class correspondingly.</p><p id="5ea0286b_77" >The actual configurations stored by the IntelliJ Platform are represented by instances of the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/RunnerAndConfigurationSettings.java" id="5ea0286b_78"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_79"  >RunnerAndConfigurationSettings</code></a> class, which combines a run configuration with runner-specific settings, as well as keeping track of certain run configuration flags such as &quot;temporary&quot; or &quot;singleton&quot;.</p><p id="5ea0286b_80" >Dealing with instances of this class becomes necessary when you need to create run configurations from code. This is accomplished with the following two steps:</p><ul class="list _ul" id="5ea0286b_81"    ><li class="list__item" id="5ea0286b_82" ><p><code class="code " id="5ea0286b_83"  >RunManager.createConfiguration()</code> creates an instance of <code class="code " id="5ea0286b_84"  >RunnerAndConfigurationSettings</code>.</p></li><li class="list__item" id="5ea0286b_85" ><p><code class="code " id="5ea0286b_86"  >RunManager.addConfiguration()</code> makes it persistent by adding it to either the list of shared configurations stored in a project or to the list of local configurations stored in the workspace file.</p></li></ul></section><section class="chapter"  ><h2 id="refactoring-support" data-toc="refactoring-support"  >Refactoring Support</h2><p id="5ea0286b_87" >Most run configurations contain references to classes, files, or directories in their settings, and these settings usually need to be updated when the corresponding element is renamed or moved.</p><p id="5ea0286b_88" >To support that, your run configuration needs to implement the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/RefactoringListenerProvider.java" id="5ea0286b_89"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_90"  >RefactoringListenerProvider</code></a> interface.</p><p id="5ea0286b_91" >In your implementation of <code class="code " id="5ea0286b_92"  >getRefactoringElementListener()</code>, you need to check whether the refactored element is the one that your run configuration refers to. If it is, you return a <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/analysis-api/src/com/intellij/refactoring/listeners/RefactoringElementListener.java" id="5ea0286b_93"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_94"  >RefactoringElementListener</code></a> that updates your configuration according to the new name and location of the element.</p></section><section class="chapter"  ><h2 id="creating-configurations-from-context" data-toc="creating-configurations-from-context"  >Creating Configurations from Context</h2><p id="5ea0286b_95" >Many plugins support automatic creation of run configurations from context so that the user can click, for example, on an application or test class and automatically run it using the correct run configuration type. To support that, you need to provide an implementation of the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-api/src/com/intellij/execution/actions/RunConfigurationProducer.java" id="5ea0286b_96"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_97"  >RunConfigurationProducer</code></a> interface and to register it as <code class="code " id="5ea0286b_98"  >&lt;runConfigurationProducer&gt;</code> in your <span class="filepath" id="5ea0286b_99" ><a href="plugin-configuration-file.html" id="5ea0286b_100" data-tooltip="Plugin configuration file contains all the information about the plugin, as well as all registered extensions, actions, listeners, etc."  >plugin.xml</a></span>. This API was redesigned in IntelliJ IDEA 13; the previous <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-api/src/com/intellij/execution/junit/RuntimeConfigurationProducer.java" id="5ea0286b_101"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_102"  >RuntimeConfigurationProducer</code></a> is a much more confusing version of the same API.</p><p id="5ea0286b_103" >The two main methods that you need to implement are:</p><ul class="list _ul" id="5ea0286b_104"    ><li class="list__item" id="5ea0286b_105" ><p><code class="code " id="5ea0286b_106"  >setupConfigurationFromContext()</code> receives a blank configuration of your type and a <code class="code " id="5ea0286b_107"  >ConfigurationContext</code> containing information about a source code location (accessible by calling <code class="code " id="5ea0286b_108"  >getLocation()</code> or <code class="code " id="5ea0286b_109"  >getPsiLocation()</code>). Your implementation needs to check whether the location is applicable for your configuration type (for example, if it's in a file of the language you're supporting). If not, you need to return false, and if it is, you need to put the correct context-specific settings into the run configuration and return true.</p></li><li class="list__item" id="5ea0286b_110" ><p><code class="code " id="5ea0286b_111"  >isConfigurationFromContext()</code> checks if your type's specified configuration was created from the specified context. Implementing this method allows you to reuse an existing run configuration, which applies to the current context instead of creating a new one and possibly ignoring the user's customizations in the existing one.</p></li></ul><p id="5ea0286b_112" >Note that, to support the automatic naming of configurations created from context, your configuration should use <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution/src/com/intellij/execution/configurations/LocatableConfigurationBase.java" id="5ea0286b_113"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_114"  >LocatableConfigurationBase</code></a> as the base class.</p></section><section class="chapter"  ><h2 id="running-from-the-gutter" data-toc="running-from-the-gutter"  >Running from the Gutter</h2><p id="5ea0286b_115" >Take a look at <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/execution-impl/src/com/intellij/execution/lineMarker/RunLineMarkerContributor.java" id="5ea0286b_116"   data-external="true" rel="noopener noreferrer" ><code class="code " id="5ea0286b_117"  >RunLineMarkerContributor</code></a> and its implementations.</p></section><div class="last-modified"> Last modified: 25 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="basic-run-configurations.html">Run Configurations</a>   <a class="navigation-links__next" href="run-configuration-execution.html">Execution</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>