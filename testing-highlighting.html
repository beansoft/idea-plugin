<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-29T19:15:57.037298"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>Testing Highlighting | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"inspections","level":0,"title":"Inspections","anchor":"#inspections"},{"id":"syntax-highlighting","level":0,"title":"Syntax Highlighting","anchor":"#syntax-highlighting"},{"id":"expected-highlighting-results","level":0,"title":"Expected Highlighting Results","anchor":"#expected-highlighting-results"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Testing Highlighting | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/testing-highlighting.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="Testing Highlighting | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/testing-highlighting.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/testing-highlighting.html", "name": "Testing Highlighting | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="testing_highlighting.md" data-main-title="Testing Highlighting" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part VI — Testing"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/basics/testing_plugins/testing_highlighting.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="testing_highlighting.md" id="testing_highlighting.md"  >Testing Highlighting</h1><p id="d904a6b_80" >When writing plugin tests, a common task is testing various kinds of highlighting (inspections, annotators, parser error highlighting, etc.). The IntelliJ Platform provides a dedicated utility and markup format for this task.</p><p id="d904a6b_81" >To test the highlighting for the file currently loaded into the in-memory editor, invoke <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/testFramework/src/com/intellij/testFramework/fixtures/CodeInsightTestFixture.java" id="d904a6b_82"   data-external="true" rel="noopener noreferrer" ><code class="code " id="d904a6b_83"  >CodeInsightTestFixture.checkHighlighting()</code></a>. The parameters to the method specify which severities should be taken into account when comparing the results with the expected results: errors are always taken into account, whereas warnings, weak warnings, and infos are optional. To ignore verifying additional highlighting, set parameter <code class="code " id="d904a6b_84"  >ignoreExtraHighlighting</code> to <code class="code " id="d904a6b_85"  >true</code>.</p><p id="d904a6b_86" >Alternatively, you can use <code class="code " id="d904a6b_87"  >CodeInsightTestFixture.testHighlighting()</code>, which loads a <a href="test-project-and-testdata-directories.html" id="d904a6b_88" data-tooltip="The test fixture creates a test project environment. Unless you customize the project creation, the test project will have one module with one source root called src. The test project files exist either in a temporary directory or in an in-memory file system, depending on which…"  >testdata file</a> into the in-memory editor and highlights it as a single operation.</p><p id="d904a6b_89" ><span class="control" id="d904a6b_90" >Example</span>: <a href="annotator-test.html" id="d904a6b_91" data-tooltip="Tested Functionality:"  >Custom Language Support Tutorial: Testing Annotator</a></p><section class="chapter"  ><h2 id="inspections" data-toc="inspections"  >Inspections</h2><p id="d904a6b_92" >If you need to test inspections, they must be enabled explicitly. This is done by calling <code class="code " id="d904a6b_93"  >CodeInsightTestFixture.enableInspections()</code> in the setup method of your test or directly in a test method, before the call to <code class="code " id="d904a6b_94"  >CodeInsightTestFixture.checkHighlighting()</code>.</p></section><section class="chapter"  ><h2 id="syntax-highlighting" data-toc="syntax-highlighting"  >Syntax Highlighting</h2><p id="d904a6b_95" >To test syntax highlighting provided by <a href="implementing-lexer.html" id="d904a6b_96" data-tooltip="A Lexer defines how a file's contents are broken into tokens."  >Lexer</a>, use <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/testFramework/src/com/intellij/testFramework/EditorTestUtil.java" id="d904a6b_97"   data-external="true" rel="noopener noreferrer" ><code class="code " id="d904a6b_98"  >EditorTestUtil.testFileSyntaxHighlighting()</code></a>.</p></section><section class="chapter"  ><h2 id="expected-highlighting-results" data-toc="expected-highlighting-results"  >Expected Highlighting Results</h2><p id="d904a6b_99" >The expected results of the highlighting are specified directly in the source file. The platform supports an extensive XML-like markup language for this. In its simplest form, the markup looks like this:</p><div class="code-block" data-lang="markup"         >
&lt;warning descr=&quot;expected warning message&quot;&gt;code to be highlighted&lt;/warning&gt;
</div><p id="d904a6b_101" >A more realistic example, embedded in Java test data to be highlighted:</p><div class="code-block" data-lang="markup"         >
public int &lt;warning descr=&quot;The compareTo() method does not reference 'foo' which is referenced from equals(); inconsistency may result&quot;&gt;compareTo&lt;/warning&gt;(Simple other) {
  return 0;
}
</div><section class="chapter"  ><h3 id="severities" data-toc="severities"  >Severities</h3><p id="d904a6b_103" >The tag name specifies the severity of the expected highlighting. The following severities are supported:</p><ul class="list _ul" id="d904a6b_104"    ><li class="list__item" id="d904a6b_105" ><p><code class="code " id="d904a6b_106"  >&lt;error&gt;</code></p></li><li class="list__item" id="d904a6b_107" ><p><code class="code " id="d904a6b_108"  >&lt;warning&gt;</code></p></li><li class="list__item" id="d904a6b_109" ><p><code class="code " id="d904a6b_110"  >&lt;weak_warning&gt;</code></p></li><li class="list__item" id="d904a6b_111" ><p><code class="code " id="d904a6b_112"  >&lt;info&gt;</code></p></li><li class="list__item" id="d904a6b_113" ><p><code class="code " id="d904a6b_114"  >&lt;inject&gt;</code> for an <a href="language-injection.html" id="d904a6b_115" data-tooltip="Language injection is the way the IntelliJ Platform handles different languages within the same source file. Well-known examples are:"  >injected fragment</a></p></li><li class="list__item" id="d904a6b_116" ><p><code class="code " id="d904a6b_117"  >&lt;symbolName&gt;</code> for a marker that highlights an identifier according to its type</p></li><li class="list__item" id="d904a6b_118" ><p>any custom severity can be referenced by its name</p></li></ul></section><section class="chapter"  ><h3 id="optional-attributes" data-toc="optional-attributes"  >Optional Attributes</h3><p id="d904a6b_119" >The tag can also have the following optional attributes.</p><p id="d904a6b_120" ><span class="control" id="d904a6b_121" >Message</span></p><ul class="list _ul" id="d904a6b_122"    ><li class="list__item" id="d904a6b_123" ><p><code class="code " id="d904a6b_124"  >descr</code> expected (hardcoded) message associated with the highlighter (if not specified, any text will match). If the message contains a quotation mark, it can be escaped by putting two backslash characters before it.</p></li><li class="list__item" id="d904a6b_125" ><p><code class="code " id="d904a6b_126"  >bundleMsg</code> expected message from a message bundle in format <code class="code " id="d904a6b_127"  >[bundleName#] bundleKey [|argument]...</code></p></li><li class="list__item" id="d904a6b_128" ><p><code class="code " id="d904a6b_129"  >tooltip</code> expected tooltip message</p></li></ul><p id="d904a6b_130" ><span class="control" id="d904a6b_131" >Visual</span></p><ul class="list _ul" id="d904a6b_132"    ><li class="list__item" id="d904a6b_133" ><p><code class="code " id="d904a6b_134"  >textAttributesKey</code> expected <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/openapi/editor/colors/TextAttributesKey.java" id="d904a6b_135"   data-external="true" rel="noopener noreferrer" ><code class="code " id="d904a6b_136"  >TextAttributesKey</code></a> referenced by its <code class="code " id="d904a6b_137"  >externalName</code></p></li><li class="list__item" id="d904a6b_138" ><p><code class="code " id="d904a6b_139"  >foregroundColor</code>, <code class="code " id="d904a6b_140"  >backgroundColor</code>, <code class="code " id="d904a6b_141"  >effectColor</code> expected colors for the highlighting</p></li><li class="list__item" id="d904a6b_142" ><p><code class="code " id="d904a6b_143"  >effectType</code> expected effect type for the highlighting (see <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/openapi/editor/markup/EffectType.java" id="d904a6b_144"   data-external="true" rel="noopener noreferrer" ><code class="code " id="d904a6b_145"  >EffectType</code></a>)</p></li><li class="list__item" id="d904a6b_146" ><p><code class="code " id="d904a6b_147"  >fontType</code> expected font style for the highlighting (<code class="code " id="d904a6b_148"  >0</code> - normal, <code class="code " id="d904a6b_149"  >1</code> - bold, <code class="code " id="d904a6b_150"  >2</code> - italic, <code class="code " id="d904a6b_151"  >3</code> - bold italic)</p></li></ul></section><section class="chapter"  ><h3 id="special-cases" data-toc="special-cases"  >Special Cases</h3><p id="d904a6b_152" ><span class="emphasis" id="d904a6b_153" >Nested</span> tags are supported:</p><div class="code-block" data-lang="markup"         >
&lt;warning&gt;warning_highlight&lt;info&gt;warning_and_info_highlight&lt;/info&gt;warning_highlight&lt;/warning&gt;
</div><p id="d904a6b_155" ><span class="emphasis" id="d904a6b_156" >Overlapping</span> tags (annotations) are currently <span class="control" id="d904a6b_157" >not supported</span> in the test framework (but displayed correctly in the editor, albeit this is not an officially supported scenario):</p><div class="code-block" data-lang="markup"         >
&lt;warning&gt;warning_highlight&lt;info&gt;warning-and_info_highlight&lt;/warning&gt;info_highlight&lt;/info&gt;
</div></section></section><div class="last-modified"> Last modified: 29 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="writing-tests.html">Writing Tests</a>   <a class="navigation-links__next" href="testing-faq.html">Testing FAQ</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>