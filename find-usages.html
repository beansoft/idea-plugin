<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-29T19:15:57.1041775"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>Find Usages | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"grouping-results","level":0,"title":"Grouping Results","anchor":"#grouping-results"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Find Usages | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/find-usages.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="Find Usages | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/find-usages.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/find-usages.html", "name": "Find Usages | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="find_usages.md" data-main-title="Find Usages" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part VII — Custom Languages///custom_language_support.md|Custom Language Support"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/reference_guide/custom_language_support/find_usages.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="find_usages.md" id="find_usages.md"  >Find Usages</h1><p id="a309178_87" >The <span class="emphasis" id="a309178_88" >Find Usages</span> action is a multi-step process, and each step of the process requires involvement from the custom language plugin.</p><p id="a309178_89" >The language plugin participates in the Find Usages process by registering an implementation of <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/indexing-api/src/com/intellij/lang/findUsages/FindUsagesProvider.java" id="a309178_90"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_91"  >FindUsagesProvider</code></a> in the <code class="code " id="a309178_92"  >com.intellij.lang.findUsagesProvider</code> extension point, and through the PSI implementation using <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiNamedElement.java" id="a309178_93"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_94"  >PsiNamedElement</code></a> and <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiReference.java" id="a309178_95"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_96"  >PsiReference</code></a> interfaces.</p><aside data-type="tip" class="prompt" data-title="" id="a309178_97" ><p id="a309178_98" >In cases like function parameters and local variables, consider overriding <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiElement.java" id="a309178_99"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_100"  >PsiElement.getUseScope()</code></a> to return a narrower scope. For instance, returning the scope of the nearest function definition can significantly reduce the number of files that need to be parsed and references that need to be resolved when renaming such elements.</p></aside><p id="a309178_101" >The steps of the <span class="emphasis" id="a309178_102" >Find Usages</span> action are the following:</p><ul class="list _ul" id="a309178_103"    ><li class="list__item" id="a309178_104" ><p>Before the <span class="emphasis" id="a309178_105" >Find Usages</span> action can be invoked, the IDE builds an index of words present in every file in the custom language. Using the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/indexing-api/src/com/intellij/lang/cacheBuilder/WordsScanner.java" id="a309178_106"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_107"  >WordsScanner</code></a> implementation returned from <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/indexing-api/src/com/intellij/lang/findUsages/FindUsagesProvider.java" id="a309178_108"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_109"  >FindUsagesProvider.getWordsScanner()</code></a>, the contents of every file are loaded and passes it to the words scanner, along with the words consumer. The words scanner breaks the text into words, defines the context for each word (code, comments, or literals), and passes the word to the consumer. The simplest way to implement the words scanner is to use the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/indexing-api/src/com/intellij/lang/cacheBuilder/DefaultWordsScanner.java" id="a309178_110"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_111"  >DefaultWordsScanner</code></a> implementation, passing to it the sets of lexer token types which are treated as identifiers, literals, and comments. The default words scanner will use the lexer to break the text into tokens and handle breaking the text of the comment and literal tokens into individual words.</p></li><li class="list__item" id="a309178_112" ><p>When the user invokes the <span class="emphasis" id="a309178_113" >Find Usages</span> action, the IDE locates the PSI element the references to be searched. The PSI element at the cursor (the direct tree parent of the token at the cursor position) must be either a <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiNamedElement.java" id="a309178_114"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_115"  >PsiNamedElement</code></a> or a <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiReference.java" id="a309178_116"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_117"  >PsiReference</code></a> which resolves to a <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiNamedElement.java" id="a309178_118"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_119"  >PsiNamedElement</code></a>. The word cache will be used to search for the text returned from the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiNamedElement.java" id="a309178_120"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_121"  >PsiNamedElement.getName()</code></a> method. Also, if the text range of the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiNamedElement.java" id="a309178_122"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_123"  >PsiNamedElement</code></a> includes some other text besides the identifier returned from <code class="code " id="a309178_124"  >getName()</code> (for example, if the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiNamedElement.java" id="a309178_125"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_126"  >PsiNamedElement</code></a> represents a JavaScript function and its text range includes the &quot;<code class="code " id="a309178_127"  >function</code>&quot; keyword in addition to the name of the function), the method <code class="code " id="a309178_128"  >getTextOffset()</code> must be overridden for the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiNamedElement.java" id="a309178_129"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_130"  >PsiNamedElement</code></a>, and must return the start offset of the name identifier within the text range of the element.</p></li><li class="list__item" id="a309178_131" ><p>Once the element is located, the IDE calls <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/indexing-api/src/com/intellij/lang/findUsages/FindUsagesProvider.java" id="a309178_132"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_133"  >FindUsagesProvider.canFindUsagesFor()</code></a> to ask the plugin if the <span class="emphasis" id="a309178_134" >Find Usages</span> action applies to the specific element.</p></li><li class="list__item" id="a309178_135" ><p>When showing the <span class="emphasis" id="a309178_136" >Find Usages</span> dialog to the user, <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/indexing-api/src/com/intellij/lang/findUsages/FindUsagesProvider.java" id="a309178_137"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_138"  >FindUsagesProvider.getType()</code></a> and <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/indexing-api/src/com/intellij/lang/findUsages/FindUsagesProvider.java" id="a309178_139"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_140"  >FindUsagesProvider.getDescriptiveName()</code></a> are called to determine how the element should be presented to the user.</p></li><li class="list__item" id="a309178_141" ><p>For every file containing the searched words, the IDE builds the PSI tree and recursively descends it. The text of each element is broken into words and then scanned. If the element was indexed as an identifier, every word is checked to be a <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/PsiReference.java" id="a309178_142"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_143"  >PsiReference</code></a> resolving to the element the usages of which are searched. If the element was indexed as a comment or literal and the search in comments or literals is enabled, it checks if the word is equal to the searched element's name.</p></li><li class="list__item" id="a309178_144" ><p>After the usages are collected, results are shown in the usages pane. The text shown for each found element is taken from the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/indexing-api/src/com/intellij/lang/findUsages/FindUsagesProvider.java" id="a309178_145"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_146"  >FindUsagesProvider.getNodeText()</code></a> method. To group results by type, implement <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/usageView-impl/src/com/intellij/usages/impl/rules/UsageTypeProvider.java" id="a309178_147"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_148"  >UsageTypeProvider</code></a> and register in <code class="code " id="a309178_149"  >com.intellij.usageTypeProvider</code> extension point to provide custom or predefined <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/usageView/src/com/intellij/usages/impl/rules/UsageType.java" id="a309178_150"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_151"  >UsageType</code></a>.</p></li></ul><p id="a309178_152" ><span class="control" id="a309178_153" >Examples</span>:</p><ul class="list _ul" id="a309178_154"    ><li class="list__item" id="a309178_155" ><p>Implementation of <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties/properties-psi-impl/src/com/intellij/lang/properties/findUsages/PropertiesFindUsagesProvider.java" id="a309178_156"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_157"  >FindUsagesProvider</code></a> in <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties" id="a309178_158"   data-external="true" rel="noopener noreferrer" >Properties language plugin</a></p></li><li class="list__item" id="a309178_159" ><p><a href="find-usages-provider.html" id="a309178_160" data-tooltip="Reference:"  >Custom Language Support Tutorial: Find Usages</a></p></li></ul><section class="chapter"  ><h2 id="grouping-results" data-toc="grouping-results"  >Grouping Results</h2><p id="a309178_161" >To have the title of the found element be correctly displayed in the title of the Find Usages tool window, you need to provide an implementation of the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/ElementDescriptionProvider.java" id="a309178_162"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_163"  >ElementDescriptionProvider</code></a> interface. The <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/psi/ElementDescriptionLocation.java" id="a309178_164"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_165"  >ElementDescriptionLocation</code></a> passed to the provider in this case will be an instance of <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/usageView/src/com/intellij/usageView/UsageViewLongNameLocation.java" id="a309178_166"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_167"  >UsageViewLongNameLocation</code></a>.</p><p id="a309178_168" ><span class="control" id="a309178_169" >Example:</span> <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties/src/com/intellij/lang/properties/PropertiesDescriptionProvider.java" id="a309178_170"   data-external="true" rel="noopener noreferrer" ><code class="code " id="a309178_171"  >ElementDescriptionProvider</code></a> for <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/plugins/properties" id="a309178_172"   data-external="true" rel="noopener noreferrer" >Properties language plugin</a></p></section><div class="last-modified"> Last modified: 29 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="code-completion.html">Code Completion</a>   <a class="navigation-links__next" href="rename-refactoring.html">Rename Refactoring</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>