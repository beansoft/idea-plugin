<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-29T19:15:56.8042468"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>Light and Heavy Tests | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"light-tests","level":0,"title":"Light Tests","anchor":"#light-tests"},{"id":"heavy-tests","level":0,"title":"Heavy Tests","anchor":"#heavy-tests"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Light and Heavy Tests | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/light-and-heavy-tests.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="Light and Heavy Tests | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/light-and-heavy-tests.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/light-and-heavy-tests.html", "name": "Light and Heavy Tests | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="light_and_heavy_tests.md" data-main-title="Light and Heavy Tests" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part VI — Testing"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/basics/testing_plugins/light_and_heavy_tests.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="light_and_heavy_tests.md" id="light_and_heavy_tests.md"  >Light and Heavy Tests</h1><p id="84bc522d_50" >Plugin tests run in a real, rather than mocked, IntelliJ Platform environment and use real implementations for most application and project <a href="plugin-services.html" id="84bc522d_51" data-tooltip="A service is a plugin component loaded on demand when your plugin calls the getService() method of corresponding ComponentManager instance (see Types). The IntelliJ Platform ensures that only one instance of a service is loaded even though it is called several times."  >services</a>.</p><p id="84bc522d_52" >Loading and initializing all the project components and services for a project to run tests is a relatively expensive operation, and we want to avoid doing it for each test. Dependently on the loading and execution time, we make a difference between <span class="emphasis" id="84bc522d_53" >light</span> tests and <span class="emphasis" id="84bc522d_54" >heavy</span> tests available in the IntelliJ Platform test framework:</p><ul class="list _ul" id="84bc522d_55"    ><li class="list__item" id="84bc522d_56" ><p><span class="emphasis" id="84bc522d_57" >Light</span> tests reuse a project from the previous test run when possible.</p></li><li class="list__item" id="84bc522d_58" ><p><span class="emphasis" id="84bc522d_59" >Heavy</span> tests create a new project for each test.</p></li></ul><p id="84bc522d_60" >Light and heavy tests use different base classes or fixture classes, as described below.</p><aside data-type="tip" class="prompt" data-title="" id="84bc522d_61" ><p id="84bc522d_62" >Because of the performance difference, we recommend plugin developers to write <span class="emphasis" id="84bc522d_63" >light</span> tests whenever possible.</p></aside><section class="chapter"  ><h2 id="light-tests" data-toc="light-tests"  >Light Tests</h2><p id="84bc522d_64" >The standard way of writing a light test is to extend the following classes:</p><ul class="list _ul" id="84bc522d_65"    ><li class="list__item" id="84bc522d_66" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/testFramework/src/com/intellij/testFramework/fixtures/BasePlatformTestCase.java" id="84bc522d_67"   data-external="true" rel="noopener noreferrer" ><code class="code " id="84bc522d_68"  >BasePlatformTestCase</code></a> (2019.2 and later) for tests that don't have any Java dependencies. For plugins using pre-2019.2 versions use <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/testFramework/src/com/intellij/testFramework/fixtures/LightPlatformCodeInsightFixtureTestCase.java" id="84bc522d_69"   data-external="true" rel="noopener noreferrer" ><code class="code " id="84bc522d_70"  >LightPlatformCodeInsightFixtureTestCase</code></a>.</p></li><li class="list__item" id="84bc522d_71" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/java/testFramework/src/com/intellij/testFramework/fixtures/LightJavaCodeInsightFixtureTestCase.java" id="84bc522d_72"   data-external="true" rel="noopener noreferrer" ><code class="code " id="84bc522d_73"  >LightJavaCodeInsightFixtureTestCase</code></a> (2019.2 and later) for tests that require the Java PSI or any related functionality. For plugins using pre-2019.2 versions use <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/java/testFramework/src/com/intellij/testFramework/fixtures/LightCodeInsightFixtureTestCase.java" id="84bc522d_74"   data-external="true" rel="noopener noreferrer" ><code class="code " id="84bc522d_75"  >LightCodeInsightFixtureTestCase</code></a>.</p></li></ul><p id="84bc522d_76" >When writing a light test, you can specify the project's requirements that you need to have in your test, such as the module type, the configured <a href="sdk.html" id="84bc522d_77" data-tooltip="Every project uses a Software Development Kit (SDK). For Java projects, the SDK is referred to as the JDK (Java Development Kit). The SDK determines which API library is used to build the project. If a project is multi-module, the project SDK by default is common for all modules…"  >SDK</a>, <a href="facet.html" id="84bc522d_78" data-tooltip="A facet represents configuration specific for a particular framework/technology, associated with a module. A module can have multiple facets. E.g. Spring Framework specific configuration is stored in a Spring facet."  >facets</a>, <a href="library.html" id="84bc522d_79" data-tooltip="A library is an archive of compiled code (such as JAR files) that modules depend on."  >libraries</a>, etc. You do so by extending the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/testFramework/src/com/intellij/testFramework/LightProjectDescriptor.java" id="84bc522d_80"   data-external="true" rel="noopener noreferrer" ><code class="code " id="84bc522d_81"  >LightProjectDescriptor</code></a> class and returning your project descriptor (usually stored in <code class="code " id="84bc522d_82"  >static final</code> field) from <code class="code " id="84bc522d_83"  >getProjectDescriptor()</code>.</p><p id="84bc522d_84" >If your plugin builds on top of Java support, please see <a href="testing-faq.html#how-to-test-a-jvm-language" id="84bc522d_85" data-tooltip="Plugins supporting a JVM language may require JDK and language standard library to be set up in a test project, so that classes like java.lang.String can be correctly resolved during tests. Tests extending LightJavaCodeInsightFixtureTestCase use one of the mock JDKs distributed with…"  >How to test a JVM language?</a> to set up your test environment to obtain the required <span class="emphasis" id="84bc522d_86" >Mock JDK</span> automatically.</p><p id="84bc522d_87" >Before executing each test, the project instance will be reused if the test case returns the same project descriptor as the previous one or recreated if the descriptor is different (<code class="code " id="84bc522d_88"  >equals() = false</code>).</p></section><section class="chapter"  ><h2 id="heavy-tests" data-toc="heavy-tests"  >Heavy Tests</h2><aside data-type="tip" class="prompt" data-title="" id="84bc522d_89" ><p id="84bc522d_90" >If you need to set up a multi-module project for your tests, you <span class="control" id="84bc522d_91" >must</span> write a heavy test.</p></aside><aside data-type="tip" class="prompt" data-title="" id="84bc522d_92" ><p id="84bc522d_93" >In 2019.3, <code class="code " id="84bc522d_94"  >PlatformTestCase</code> has been renamed to <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/testFramework/src/com/intellij/testFramework/HeavyPlatformTestCase.java" id="84bc522d_95"   data-external="true" rel="noopener noreferrer" ><code class="code " id="84bc522d_96"  >HeavyPlatformTestCase</code></a> reflecting its &quot;heavy test&quot; characteristics.</p></aside><p id="84bc522d_97" >The setup code for a multi-module Java project looks something like that:</p><div class="code-block" data-lang="java"         >
TestFixtureBuilder&lt;IdeaProjectTestFixture&gt; projectBuilder =
        IdeaTestFixtureFactory.getFixtureFactory().createFixtureBuilder(getName());

// Repeat the following line for each module
JavaModuleFixtureBuilder moduleFixtureBuilder =
        projectBuilder.addModule(JavaModuleFixtureBuilder.class);

myFixture = JavaTestFixtureFactory.getFixtureFactory()
        .createCodeInsightFixture(projectBuilder.getFixture());
</div></section><div class="last-modified"> Last modified: 29 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="tests-and-fixtures.html">Tests and Fixtures</a>   <a class="navigation-links__next" href="test-project-and-testdata-directories.html">Test Project and Testdata Directories</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>