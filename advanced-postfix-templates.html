<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-28T11:33:50.7278206"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>Advanced Postfix Templates | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"postfix-templates-with-expression-selector","level":0,"title":"Postfix Templates With Expression Selector","anchor":"#postfix-templates-with-expression-selector"},{"id":"live-template-syntax-based-postfix-templates","level":0,"title":"Live Template Syntax-Based Postfix Templates","anchor":"#live-template-syntax-based-postfix-templates"},{"id":"editable-postfix-templates","level":0,"title":"Editable Postfix Templates","anchor":"#editable-postfix-templates"},{"id":"surround-postfix-templates","level":0,"title":"Surround Postfix Templates","anchor":"#surround-postfix-templates"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Advanced Postfix Templates | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/advanced-postfix-templates.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="Advanced Postfix Templates | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/advanced-postfix-templates.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/advanced-postfix-templates.html", "name": "Advanced Postfix Templates | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="advanced_postfix_templates.md" data-main-title="Advanced Postfix Templates" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part V — Features///editing.md|Editing///postfix_completion.md|Postfix Completion"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/tutorials/postfix_completion/advanced_postfix_templates.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="advanced_postfix_templates.md" id="advanced_postfix_templates.md"  >Advanced Postfix Templates</h1><p id="bebff5ea_1" ></p><p id="bebff5ea_3" >While <a href="postfix-templates.html" id="bebff5ea_4" data-tooltip="Postfix templates implement possibility to modify or wrap the existing code in additional constructs without navigating the caret back."  >simple templates</a> can be handled by extending <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/template/postfix/templates/PostfixTemplate.java" id="bebff5ea_5"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_6"  >PostfixTemplate</code></a> class directly, more advanced templates require additional functionalities like selecting the expression that a template should be applied to or editing a template content. The IntelliJ Platform provides the base classes simplifying advanced template's features implementation.</p><section class="chapter"  ><h2 id="postfix-templates-with-expression-selector" data-toc="postfix-templates-with-expression-selector"  >Postfix Templates With Expression Selector</h2><p id="bebff5ea_7" >In some contexts, it is not obvious what expression a template should be applied to. Consider the following Java code with the <code class="code " id="bebff5ea_8"  >var</code> postfix template at the end:</p><div class="code-block" data-lang="java"         >
order.calculateWeight() &gt; getMaxWeight(order.getDeliveryType()).var
</div><p id="bebff5ea_10" >In the above code, a postfix template could be applied to the <code class="code " id="bebff5ea_11"  >getMaxWeight()</code> method invocation and the entire comparison expression depending on the user's intention. The postfix template implementation could automatically apply the template on the topmost or the closest applicable expression, but it is reasonable to leave the expression selection for the user.</p><p id="bebff5ea_12" >Postfix templates with expression selector can be achieved by implementing <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/template/postfix/templates/PostfixTemplateWithExpressionSelector.java" id="bebff5ea_13"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_14"  >PostfixTemplateWithExpressionSelector</code></a> and <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/template/postfix/templates/PostfixTemplateExpressionSelector.java" id="bebff5ea_15"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_16"  >PostfixTemplateExpressionSelector</code></a> classes.</p><p id="bebff5ea_17" ><span class="control" id="bebff5ea_18" >Example:</span> <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/java/java-impl/src/com/intellij/codeInsight/template/postfix/templates/IntroduceFieldPostfixTemplate.java" id="bebff5ea_19"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_20"  >IntroduceFieldPostfixTemplate</code></a> introduces a Java class field, allowing to select one of the non-void expressions at the current offset.</p></section><section class="chapter"  ><h2 id="live-template-syntax-based-postfix-templates" data-toc="live-template-syntax-based-postfix-templates"  >Live Template Syntax-Based Postfix Templates</h2><p id="bebff5ea_21" >The IntelliJ Platform-based IDEs provide the <a href="https://www.jetbrains.com/help/idea/using-live-templates.html" id="bebff5ea_22"   data-external="true" rel="noopener noreferrer" >Live Templates</a> feature. It allows defining a template text with dynamic expressions, replaced with actual values depending on the context. If the implemented postfix template's expanding behavior can be achieved with the live template syntax, it is much easier to extend the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/template/postfix/templates/StringBasedPostfixTemplate.java" id="bebff5ea_23"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_24"  >StringBasedPostfixTemplate</code></a> than implementing the expansion behavior programmatically.</p><p id="bebff5ea_25" ><span class="control" id="bebff5ea_26" >Example:</span> <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/java/java-impl/src/com/intellij/codeInsight/template/postfix/templates/StreamPostfixTemplate.java" id="bebff5ea_27"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_28"  >StreamPostfixTemplate</code></a> wraps array expression within the <code class="code " id="bebff5ea_29"  >Arrays.stream()</code> method.</p><aside data-type="tip" class="prompt" data-title="" id="bebff5ea_30" ><p id="bebff5ea_31" >See the <a href="live-templates.html" id="bebff5ea_32" data-tooltip="Live Templates are customizable rules that allow developers to abbreviate repetitive text patterns or surround code fragments with repetitive constructs in the editor."  >Live Templates</a> section in SDK Docs for information on implementing the live templates feature in a plugin.</p></aside></section><section class="chapter"  ><h2 id="editable-postfix-templates" data-toc="editable-postfix-templates"  >Editable Postfix Templates</h2><p id="bebff5ea_33" >All postfix templates that return <code class="code " id="bebff5ea_34"  >true</code> from the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/template/postfix/templates/PostfixTemplate.java" id="bebff5ea_35"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_36"  >PostfixTemplate.isEditable()</code></a> method and have a key starting with <code class="code " id="bebff5ea_37"  >.</code> (dot) can be edited. In the simplest case, only the template's name can be edited. To provide more advanced editing possibilities, like creating new templates in the settings dialog, editing the template's content, variables, expression conditions, etc., a plugin must implement the related <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/template/postfix/templates/PostfixTemplateProvider.java" id="bebff5ea_38"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_39"  >PostfixTemplateProvider's</code></a> methods:</p><ul class="list _ul" id="bebff5ea_40"    ><li class="list__item" id="bebff5ea_41" ><p><code class="code " id="bebff5ea_42"  >PostfixTemplateProvider.createEditor()</code> - returns an instance of the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/template/postfix/templates/editable/PostfixTemplateEditor.java" id="bebff5ea_43"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_44"  >PostfixTemplateEditor</code></a> class which is responsible for building the UI settings for a particular template and creating a template from the settings provided in this UI. The editor UI may contain settings controls other than the textual editor, like lists, checkboxes, etc.</p></li><li class="list__item" id="bebff5ea_45" ><p><code class="code " id="bebff5ea_46"  >PostfixTemplateProvider.writeExternalTemplate()</code> and <code class="code " id="bebff5ea_47"  >readExternalTemplate()</code> - serializes/deserializes a given template to/from XML elements. Serialized template data is stored in the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/template/postfix/settings/PostfixTemplateStorage.java" id="bebff5ea_48"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_49"  >PostfixTemplateStorage</code></a> <a href="persisting-state-of-components.html" id="bebff5ea_50" data-tooltip="The IntelliJ Platform provides an API that allows components or services to persist their state between restarts of the IDE. You can use either a simple API to persist a few values or persist the state of more complicated components using the PersistentStateComponent interface."  >persistent component</a>.</p></li></ul><p id="bebff5ea_51" >Implementing template, editor, and serialization methods from scratch is a tedious task, so the IntelliJ Platform provides classes that help implement editable templates:</p><ul class="list _ul" id="bebff5ea_52"    ><li class="list__item" id="bebff5ea_53" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/template/postfix/templates/editable/EditablePostfixTemplateWithMultipleExpressions.java" id="bebff5ea_54"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_55"  >EditablePostfixTemplateWithMultipleExpressions</code></a> for editable templates with expression selector and conditions limiting the applicable contexts. Like <a href="#live-template-syntax-based-postfix-templates" id="bebff5ea_56" data-tooltip="The IntelliJ Platform-based IDEs provide the Live Templates feature. It allows defining a template text with dynamic expressions, replaced with actual values depending on the context. If the implemented postfix template's expanding behavior can be achieved with the live template…"  >Live Template Syntax-Based Postfix Templates</a>, it is text-based and uses the same live template syntax.</p></li><li class="list__item" id="bebff5ea_57" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/template/postfix/settings/PostfixTemplateEditorBase.java" id="bebff5ea_58"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_59"  >PostfixTemplateEditorBase</code></a> for editors implementing the most common features like editing content, expression conditions, or using the topmost expression for template expanding</p></li><li class="list__item" id="bebff5ea_60" ><p>Utility class <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/template/postfix/templates/PostfixTemplatesUtils.java" id="bebff5ea_61"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_62"  >PostfixTemplatesUtils</code></a> providing methods related to editable template data serialization</p></li></ul><p id="bebff5ea_63" ><span class="control" id="bebff5ea_64" >Examples:</span></p><ul class="list _ul" id="bebff5ea_65"    ><li class="list__item" id="bebff5ea_66" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/java/java-impl/src/com/intellij/codeInsight/template/postfix/templates/JavaPostfixTemplateProvider.java" id="bebff5ea_67"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_68"  >JavaPostfixTemplateProvider</code></a> providing Java editable templates</p></li><li class="list__item" id="bebff5ea_69" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/java/java-impl/src/com/intellij/codeInsight/template/postfix/templates/editable/JavaPostfixTemplateEditor.java" id="bebff5ea_70"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_71"  >JavaPostfixTemplateEditor</code></a> implementing editor for Java editable templates</p></li><li class="list__item" id="bebff5ea_72" ><p><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/java/java-impl/src/com/intellij/codeInsight/template/postfix/templates/ObjectsRequireNonNullPostfixTemplate.java" id="bebff5ea_73"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_74"  >ObjectsRequireNonNullPostfixTemplate</code></a> implementing template wrapping the selected expression in <code class="code " id="bebff5ea_75"  >Objects.requireNonNull()</code> method</p></li></ul></section><section class="chapter"  ><h2 id="surround-postfix-templates" data-toc="surround-postfix-templates"  >Surround Postfix Templates</h2><p id="bebff5ea_76" >Existing <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-api/src/com/intellij/lang/surroundWith/Surrounder.java" id="bebff5ea_77"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_78"  >Surrounder</code></a> implementations of the <a href="surround-with.html" id="bebff5ea_79" data-tooltip="To support the Surround With action, the plugin needs to register one or more implementations of the SurroundDescriptor interface in the com.intellij.lang.surroundDescriptor extension point. Each of the surround descriptors defines a possible type of code fragment that can be…"  >Surround With</a> feature required to invoke the  action can be reused for postfix completion by extending the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/template/postfix/templates/SurroundPostfixTemplateBase.java" id="bebff5ea_81"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_82"  >SurroundPostfixTemplateBase</code></a> class and returning the surrounder object from the <code class="code " id="bebff5ea_83"  >getSurrounder()</code> method.</p><p id="bebff5ea_84" ><span class="control" id="bebff5ea_85" >Example:</span> <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/java/java-impl/src/com/intellij/codeInsight/template/postfix/templates/NotNullCheckPostfixTemplate.java" id="bebff5ea_86"   data-external="true" rel="noopener noreferrer" ><code class="code " id="bebff5ea_87"  >NotNullCheckPostfixTemplate</code></a> surrounding the selected expression with an <code class="code " id="bebff5ea_88"  >if</code> statement checking if the expression is <code class="code " id="bebff5ea_89"  >null</code>.</p></section><div class="last-modified"> Last modified: 28 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="postfix-templates.html">Postfix Templates</a>   <a class="navigation-links__next" href="templates.html">Templates</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>