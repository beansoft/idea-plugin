<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-25T22:17:42.5079309"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>Text Selection | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"extendingshrinking-text-selection","level":0,"title":"Extending/Shrinking Text Selection","anchor":"#extendingshrinking-text-selection"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Text Selection | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/text-selection.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="Text Selection | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/text-selection.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/text-selection.html", "name": "Text Selection | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="text_selection.md" data-main-title="Text Selection" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part II — Base Platform///editors.md|Editors"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/reference_guide/text_selection.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="text_selection.md" id="text_selection.md"  >Text Selection</h1><section class="chapter"  ><h2 id="extendingshrinking-text-selection" data-toc="extendingshrinking-text-selection"  >Extending/Shrinking Text Selection</h2><p id="610b2c6c_1" >Implementing <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-api/src/com/intellij/codeInsight/editorActions/ExtendWordSelectionHandler.java" id="610b2c6c_2"   data-external="true" rel="noopener noreferrer" ><code class="code " id="610b2c6c_3"  >ExtendWordSelectionHandler</code></a> and registering it as <code class="code " id="610b2c6c_4"  >com.intellij.extendWordSelectionHandler</code> EP in your <span class="filepath" id="610b2c6c_5" ><a href="plugin-configuration-file.html" id="610b2c6c_6" data-tooltip="Plugin configuration file contains all the information about the plugin, as well as all registered extensions, actions, listeners, etc."  >plugin.xml</a></span> allows you to provide additional text ranges to be used when extending or shrinking a selection. Return <code class="code " id="610b2c6c_7"  >true</code> from <code class="code " id="610b2c6c_8"  >canSelect(PsiElement)</code> for the PSI elements that you want to provide additional text-ranges for. The IntelliJ Platform will call <code class="code " id="610b2c6c_9"  >select(PsiElement, CharSequence, int, Editor)</code> for these elements where you can compute additional text ranges and return them as <code class="code " id="610b2c6c_10"  >List&lt;TextRange&gt;</code>.</p><p id="610b2c6c_11" >See also:</p><ul class="list _ul" id="610b2c6c_12"    ><li class="list__item" id="610b2c6c_13" ><p><a href="surround-with.html" id="610b2c6c_14" data-tooltip="To support the Surround With action, the plugin needs to register one or more implementations of the SurroundDescriptor interface in the com.intellij.lang.surroundDescriptor extension point. Each of the surround descriptors defines a possible type of code fragment that can be…"  >Surround With</a></p></li><li class="list__item" id="610b2c6c_15" ><p><a href="additional-minor-features.html" id="610b2c6c_16" data-tooltip="Additional minor features for custom languages."  >List of minor features</a></p></li></ul><section class="chapter"  ><h3 id="overview" data-toc="overview"  >Overview</h3><p id="610b2c6c_17" >The two actions <a href="https://www.jetbrains.com/help/idea/working-with-source-code.html#editor_code_selection" id="610b2c6c_18"   data-external="true" rel="noopener noreferrer" >Extend Selection and Shrink Selection</a> in IntelliJ Platform IDEs let you adjust selected text based on the structure of the source code. This makes it easy to select not only expressions, blocks, and function definitions, but also code like whole lines or tags in JavaDoc comments.</p><p id="610b2c6c_19" >When implementing a custom language, the IntelliJ Platform provides basic implementations of this EP, allowing you to select code based on your PSI structure and to select whole lines. In many cases this is sufficient to provide a good user experience. However, sometimes it's advantageous to provide additional regions that the user may wish to be able to select when extending or shrinking a selection.</p><p id="610b2c6c_20" >This EP has two methods that need to be implemented:</p><ol class="list _decimal" id="610b2c6c_21"  type="1"  ><li class="list__item" id="610b2c6c_22" ><p><code class="code " id="610b2c6c_23"  >canSelect(PsiElement)</code> is called on each PSI element, starting from the element at the cursor and walking up each of its parents. Return <code class="code " id="610b2c6c_24"  >true</code> for a particular element to indicate that further text-ranges should be included for the PSI element.</p></li><li class="list__item" id="610b2c6c_25" ><p><code class="code " id="610b2c6c_26"  >select(PsiElement, CharSequence, int, Editor)</code> returns the text-ranges within the PSI element of interest are calculated and returned.</p></li></ol></section><section class="chapter"  ><h3 id="example-use-case" data-toc="example-use-case"  >Example Use-Case</h3><p id="610b2c6c_27" >A possible use-case for custom language developers is a function call <code class="code " id="610b2c6c_28"  >f(a, b)</code> where the function call node has its two arguments as children. If the cursor is located at argument <code class="code " id="610b2c6c_29"  >a</code>, extending the selection would first select argument <code class="code " id="610b2c6c_30"  >a</code> itself and in the next step grow to cover the whole function call. However, you might want to select the list of all arguments as an intermediate step. This can be achieved by implementing this EP in the following way:</p><ol class="list _decimal" id="610b2c6c_31"  type="1"  ><li class="list__item" id="610b2c6c_32" ><p>Create a class that implements the <code class="code " id="610b2c6c_33"  >ExtendWordSelectionHandler</code> interface and register it as a <code class="code " id="610b2c6c_34"  >com.intellij.extendWordSelectionHandler</code> EP in your <span class="filepath" id="610b2c6c_35" >plugin.xml</span>.</p></li><li class="list__item" id="610b2c6c_36" ><p>The <code class="code " id="610b2c6c_37"  >canSelect(PsiElement)</code> method should return <code class="code " id="610b2c6c_38"  >true</code> for the function call node. That indicates that <code class="code " id="610b2c6c_39"  >select(PsiElement, CharSequence, int, Editor)</code> will be called for the function-call node.</p></li><li class="list__item" id="610b2c6c_40" ><p>When the <code class="code " id="610b2c6c_41"  >select()</code> method is called, you can use the function call PSI element or the editor text to extract the text range that spans the arguments <code class="code " id="610b2c6c_42"  >a</code> and <code class="code " id="610b2c6c_43"  >b</code> and return it as <code class="code " id="610b2c6c_44"  >List&lt;TextRange&gt;</code> with one element.</p></li></ol></section><section class="chapter"  ><h3 id="further-insight-and-debugging" data-toc="further-insight-and-debugging"  >Further Insight and Debugging</h3><p id="610b2c6c_45" >Looking at other implementations can be an effective way to get a better understanding of how this EP works. To get further insight into this EP, you may want to take a look at <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/java/java-impl/src/com/intellij/codeInsight/editorActions/wordSelection/DocTagSelectioner.java" id="610b2c6c_46"   data-external="true" rel="noopener noreferrer" ><code class="code " id="610b2c6c_47"  >DocTagSelectioner</code></a>. It provides the ability to select tag names like <code class="code " id="610b2c6c_48"  >@param</code> in JavaDoc comments. Additionally, the <a href="https://plugins.jetbrains.com/intellij-platform-explorer/?extensions=com.intellij.extendWordSelectionHandler" id="610b2c6c_49"   data-external="true" rel="noopener noreferrer" >IntelliJ Platform Explorer</a> provides a list of open-source plugins with implementations of the <code class="code " id="610b2c6c_50"  >extendWordSelectionHandler</code> EP.</p><p id="610b2c6c_51" >There are also some important places in the IntelliJ Platform to add breakpoints during debugging. When <span class="emphasis" id="610b2c6c_52" >Extend Selection</span> is called by the user, it is handled by <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/editorActions/SelectWordHandler.java" id="610b2c6c_53"   data-external="true" rel="noopener noreferrer" ><code class="code " id="610b2c6c_54"  >SelectWordHandler</code></a>. The majority of the work, however, is then done inside <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/lang-impl/src/com/intellij/codeInsight/editorActions/SelectWordUtil.java" id="610b2c6c_55"   data-external="true" rel="noopener noreferrer" ><code class="code " id="610b2c6c_56"  >SelectWordUtil</code></a>, where <code class="code " id="610b2c6c_57"  >processElement()</code> checks which implementations of this EP apply for the current PSI element. If one of them returns <code class="code " id="610b2c6c_58"  >true</code> from its <code class="code " id="610b2c6c_59"  >canSelect()</code> method, the additional text ranges are extracted in the <code class="code " id="610b2c6c_60"  >askSelectioner()</code> function. These places are good candidates to set breakpoints and investigate during debugging.</p></section></section><div class="last-modified"> Last modified: 25 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="editor-events.html">3. Handling Editor Events</a>   <a class="navigation-links__next" href="multiple-carets.html">Multiple Carets</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>