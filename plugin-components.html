<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-29T19:15:56.847256"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>Components | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"migration","level":0,"title":"Migration","anchor":"#migration"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="Components | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/plugin-components.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="Components | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/plugin-components.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/plugin-components.html", "name": "Components | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="plugin_components.md" data-main-title="Components" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part I — 插件///plugin_structure.md|Plugin Structure"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/basics/plugin_structure/plugin_components.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="plugin_components.md" id="plugin_components.md"  >Components</h1><aside data-type="tip" class="prompt" data-title="" id="ecd1fa4e_56" ><p id="ecd1fa4e_57" >When writing new plugins, creating Components should be avoided. Any existing Components should be migrated to services, extensions, or listeners (see below).</p></aside><p id="ecd1fa4e_58" >Plugin Components are a legacy feature supported for compatibility with plugins created for older versions of the IntelliJ Platform. Plugins using Components do not support <a href="dynamic-plugins.html" id="ecd1fa4e_59" data-tooltip="Starting with the 2020.1 release, installing, updating, and uninstalling plugins without restarting the IDE is available in the IntelliJ Platform."  >dynamic loading</a> (the ability to install, update, and uninstall plugins without restarting the IDE).</p><p id="ecd1fa4e_60" >Plugin Components are defined in the <code class="code " id="ecd1fa4e_61"  >&lt;application-components&gt;</code>, <code class="code " id="ecd1fa4e_62"  >&lt;project-components&gt;</code>, and <code class="code " id="ecd1fa4e_63"  >&lt;module-components&gt;</code> sections in a <a href="plugin-configuration-file.html" id="ecd1fa4e_64" data-tooltip="Plugin configuration file contains all the information about the plugin, as well as all registered extensions, actions, listeners, etc."  >Plugin Configuration File</a>.</p><section class="chapter"  ><h2 id="migration" data-toc="migration"  >Migration</h2><p id="ecd1fa4e_65" >To migrate existing code from Components to more modern APIs, please see the following guidelines.</p><section class="chapter"  ><h3 id="manage-state" data-toc="manage-state"  >Manage State</h3><p id="ecd1fa4e_66" >To manage some state or logic that is only needed when the user performs a specific operation, use a <a href="plugin-services.html" id="ecd1fa4e_67" data-tooltip="A service is a plugin component loaded on demand when your plugin calls the getService() method of corresponding ComponentManager instance (see Types). The IntelliJ Platform ensures that only one instance of a service is loaded even though it is called several times."  >Service</a>.</p></section><section class="chapter"  ><h3 id="persisting-state" data-toc="persisting-state"  >Persisting State</h3><p id="ecd1fa4e_68" >To store the state of your plugin at the application or project level, use a <a href="plugin-services.html" id="ecd1fa4e_69" data-tooltip="A service is a plugin component loaded on demand when your plugin calls the getService() method of corresponding ComponentManager instance (see Types). The IntelliJ Platform ensures that only one instance of a service is loaded even though it is called several times."  >Service</a>, and implement the <code class="code " id="ecd1fa4e_70"  >PersistentStateComponent</code> interface. See <a href="persisting-state-of-components.html" id="ecd1fa4e_71" data-tooltip="The IntelliJ Platform provides an API that allows components or services to persist their state between restarts of the IDE. You can use either a simple API to persist a few values or persist the state of more complicated components using the PersistentStateComponent interface."  >Persisting State of Components</a> for details.</p></section><section class="chapter"  ><h3 id="subscribing-to-events" data-toc="subscribing-to-events"  >Subscribing to Events</h3><p id="ecd1fa4e_72" >To subscribe to events, use a <a href="plugin-listeners.html" id="ecd1fa4e_73" data-tooltip="Listeners allow subscription to application and project events."  >listener</a> or create an <a href="plugin-extensions.html" id="ecd1fa4e_74" data-tooltip="Extensions are the most common way of customizing functionality in the IDE."  >extension</a> for a dedicated extension point (for example, <code class="code " id="ecd1fa4e_75"  >com.intellij.editorFactoryListener</code>) if one exists for the event to subscribe to.</p></section><section class="chapter"  ><h3 id="application-startup" data-toc="application-startup"  >Application Startup</h3><aside data-type="tip" class="prompt" data-title="" id="ecd1fa4e_76" ><p id="ecd1fa4e_77" >Executing code on application startup should be avoided whenever possible because it slows down startup.</p></aside><p id="ecd1fa4e_78" >Plugin code should only be executed when projects are opened (see <a href="#project-open" id="ecd1fa4e_79" data-tooltip="To execute code when a project is being opened, use one of these two extensions:"  >Project Open</a>) or when the user invokes an action of a plugin. If this cannot be avoided, add a <a href="plugin-listeners.html" id="ecd1fa4e_80" data-tooltip="Listeners allow subscription to application and project events."  >listener</a> subscribing to the <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/platform-impl/src/com/intellij/ide/AppLifecycleListener.java" id="ecd1fa4e_81"   data-external="true" rel="noopener noreferrer" ><code class="code " id="ecd1fa4e_82"  >AppLifecycleListener</code></a> topic. See also <a href="ide-infrastructure.html" id="ecd1fa4e_83" data-tooltip="If your plugin uses log4j library directly: it is removed from IntelliJ Platform in 2022.1; please see this blog post for migration instructions."  >Running Tasks Once</a>.</p><p id="ecd1fa4e_84" >To execute an activity in background on IDE startup (e.g., to warm up caches), use <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/ide-core/src/com/intellij/openapi/application/PreloadingActivity.java" id="ecd1fa4e_85"   data-external="true" rel="noopener noreferrer" ><code class="code " id="ecd1fa4e_86"  >PreloadingActivity</code></a>.</p></section><section class="chapter"  ><h3 id="project-open" data-toc="project-open"  >Project Open</h3><p id="ecd1fa4e_87" >To execute code when a project is being opened, use one of these two <a href="plugin-extensions.html" id="ecd1fa4e_88" data-tooltip="Extensions are the most common way of customizing functionality in the IDE."  >extensions</a>:</p><section class="chapter"  ><h4 id="comintellijpoststartupactivity" data-toc="comintellijpoststartupactivity"  >com.intellij.postStartupActivity</h4><p id="ecd1fa4e_89" ><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/openapi/startup/StartupActivity.java" id="ecd1fa4e_90"   data-external="true" rel="noopener noreferrer" ><code class="code " id="ecd1fa4e_91"  >StartupActivity</code></a> for immediate execution on EDT. Implement <code class="code " id="ecd1fa4e_92"  >DumbAware</code> to indicate activity can run in background thread (in parallel with other such tasks).</p></section><section class="chapter"  ><h4 id="comintellijbackgroundpoststartupactivity" data-toc="comintellijbackgroundpoststartupactivity"  >com.intellij.backgroundPostStartupActivity</h4><p id="ecd1fa4e_93" ><a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/openapi/startup/StartupActivity.java" id="ecd1fa4e_94"   data-external="true" rel="noopener noreferrer" ><code class="code " id="ecd1fa4e_95"  >StartupActivity.Background</code></a> for execution with 5 seconds delay in background thread (2019.3 or later).</p><p id="ecd1fa4e_96" >Any long-running or CPU intensive tasks should be made visible to users by using <code class="code " id="ecd1fa4e_97"  >ProgressManager.run(Task.Backgroundable)</code>. Access to indices must be wrapped with <code class="code " id="ecd1fa4e_98"  >DumbService</code>, see also <a href="general-threading-rules.html" id="ecd1fa4e_99" data-tooltip="Thread Access Info 插件在调试器中可视化显示读/写锁访问以及线程信息."  >General Threading Rules</a>.</p><p id="ecd1fa4e_100" >See also <a href="ide-infrastructure.html#running-tasks-once" id="ecd1fa4e_101" data-tooltip="Use RunOnceUtil to run a task exactly once per project/application."  >Running Tasks Once</a>.</p></section></section><section class="chapter"  ><h3 id="project-and-application-close" data-toc="project-and-application-close"  >Project and Application Close</h3><p id="ecd1fa4e_102" >To execute code on project closing or application shutdown, implement the <code class="code " id="ecd1fa4e_103"  >Disposable</code> interface in a <a href="plugin-services.html" id="ecd1fa4e_104" data-tooltip="A service is a plugin component loaded on demand when your plugin calls the getService() method of corresponding ComponentManager instance (see Types). The IntelliJ Platform ensures that only one instance of a service is loaded even though it is called several times."  >Service</a> and place the code in the <code class="code " id="ecd1fa4e_105"  >dispose()</code> method. Alternatively, use <code class="code " id="ecd1fa4e_106"  >Disposer.register()</code> passing a <code class="code " id="ecd1fa4e_107"  >Project</code> or <code class="code " id="ecd1fa4e_108"  >Application</code> service instance as the <code class="code " id="ecd1fa4e_109"  >parent</code> argument (see <a href="disposers.html#choosing-a-disposable-parent" id="ecd1fa4e_110" data-tooltip="To register a child Disposable, a parent Disposable of a suitable lifetime is used to establish the parent-child relationship. One of the parent Disposables provided by the IntelliJ Platform can be chosen, or it can be another Disposable."  >Choosing a Disposable Parent</a>).</p></section></section><div class="last-modified"> Last modified: 29 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="plugin-extension-points.html">Extension Points</a>   <a class="navigation-links__next" href="plugin-configuration-file.html">Plugin Configuration File</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>