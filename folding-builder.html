<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">  <meta name="built-on" content="2022-09-29T19:15:56.4981763"><meta name="build-number" content="${buildNumber}">    <meta name="keywords" content="">  <title>12. Folding Builder | IntelliJ Platform Plugin SDK</title><script id="virtual-toc-data" type="application/json">[{"id":"define-a-folding-builder","level":0,"title":"Define a Folding Builder","anchor":"#define-a-folding-builder"},{"id":"register-the-folding-builder","level":0,"title":"Register the Folding Builder","anchor":"#register-the-folding-builder"},{"id":"run-the-project","level":0,"title":"Run the Project","anchor":"#run-the-project"}]</script>   <link href="https://resources.jetbrains.com/storage/help-app/v5/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- Open Graph --><meta property="og:title" content="12. Folding Builder | IntelliJ Platform Plugin SDK"/><meta property="og:description" content=""/><meta property="og:image" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"/><meta property="og:site_name" content="IntelliJ Platform Plugin SDK Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="https://plugins.jetbrains.com/docs/intellij/folding-builder.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@JBPlatform"><meta name="twitter:title" content="12. Folding Builder | IntelliJ Platform Plugin SDK"><meta name="twitter:description" content=""><meta name="twitter:creator" content="@JBPlatform"><meta name="twitter:image:src" content="https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png"><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "https://plugins.jetbrains.com/docs/intellij/folding-builder.html#webpage", "url": "https://plugins.jetbrains.com/docs/intellij/folding-builder.html", "name": "12. Folding Builder | IntelliJ Platform Plugin SDK", "description": "", "image": "https://resources.jetbrains.com/storage/products/jetbrains/img/meta/preview.png", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "https://plugins.jetbrains.com/docs/intellij/#website", "url": "https://plugins.jetbrains.com/docs/intellij/", "name": "IntelliJ Platform Plugin SDK Help" }</script><!-- End Schema.org --></head>    <body data-id="folding_builder.md" data-main-title="12. Folding Builder" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Part VII — Custom Languages///custom_language_support_tutorial.md|Custom Language Support Tutorial"  data-edit-url="https://github.com/JetBrains/intellij-sdk-docs/edit/main/topics/tutorials/custom_language_support/folding_builder.md"  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>IntelliJ Platform Plugin SDK  Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">      </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="folding_builder.md" id="folding_builder.md"  >12. Folding Builder</h1><p id="6e3f85fb_55" >A folding builder identifies the folding regions in the code. In this step of the tutorial, the folding builder is used to identify folding regions and replace the regions with specific text. Rather than the usual practice of using a folding builder to collapse a class, method, or comments to fewer lines, the folding builder replaces Simple Language keys with their corresponding values.</p><section class="chapter"  ><h2 id="define-a-folding-builder" data-toc="define-a-folding-builder"  >Define a Folding Builder</h2><p id="6e3f85fb_56" >The <a href="https://github.com/JetBrains/intellij-sdk-code-samples/tree/main/simple_language_plugin/src/main/java/org/intellij/sdk/language/SimpleFoldingBuilder.java" id="6e3f85fb_57"   data-external="true" rel="noopener noreferrer" ><code class="code " id="6e3f85fb_58"  >SimpleFoldingBuilder</code></a> replaces usages of properties with their values by default. Start by subclassing <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/lang/folding/FoldingBuilderEx.java" id="6e3f85fb_59"   data-external="true" rel="noopener noreferrer" ><code class="code " id="6e3f85fb_60"  >FoldingBuilderEx</code></a></p><p id="6e3f85fb_61" >Note that <code class="code " id="6e3f85fb_62"  >SimpleFoldingBuilder</code> also implements <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/openapi/project/DumbAware.java" id="6e3f85fb_63"   data-external="true" rel="noopener noreferrer" ><code class="code " id="6e3f85fb_64"  >DumbAware</code></a>, which means the class is allowed to run in dumb mode, when indices are in background update.</p><aside data-type="tip" class="prompt" data-title="" id="6e3f85fb_65" ><p id="6e3f85fb_66" >A folding builder must implement <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/openapi/project/DumbAware.java" id="6e3f85fb_67"   data-external="true" rel="noopener noreferrer" ><code class="code " id="6e3f85fb_68"  >DumbAware</code></a> to function in this tutorial and pass tests.</p></aside><p id="6e3f85fb_69" >The <code class="code " id="6e3f85fb_70"  >buildFoldRegions()</code> method searches down a PSI tree from <code class="code " id="6e3f85fb_71"  >root</code> to find all literal expressions containing the <a href="annotator.html#define-an-annotator" id="6e3f85fb_72" data-tooltip="The SimpleAnnotator subclasses Annotator. Consider a literal string that starts with "simple:" as a prefix of a Simple Language key. It isn't part of the Simple Language, but it is a useful convention for detecting Simple Language keys embedded as string literals in other languages,…"  >simple prefix</a> <code class="code " id="6e3f85fb_73"  >simple:</code>. The remainder of such a string is expected to contain a Simple Language key, and so the text range is stored as a <a href="https://github.com/JetBrains/intellij-community/tree/idea/222.3739.54/platform/core-api/src/com/intellij/lang/folding/FoldingDescriptor.java" id="6e3f85fb_74"   data-external="true" rel="noopener noreferrer" ><code class="code " id="6e3f85fb_75"  >FoldingDescriptor</code></a>.</p><p id="6e3f85fb_76" >The <code class="code " id="6e3f85fb_77"  >getPlaceholderText()</code> method retrieves the Simple Language value corresponding to the key associated with the (ASTNode) provided. The IntelliJ Platform uses the value to substitute for the key when the code gets folded.</p><div class="code-block" data-lang="java"       data-disable-link-processing="true"  ></div></section><section class="chapter"  ><h2 id="register-the-folding-builder" data-toc="register-the-folding-builder"  >Register the Folding Builder</h2><p id="6e3f85fb_79" >The <code class="code " id="6e3f85fb_80"  >SimpleFoldingBuilder</code> implementation is registered with the IntelliJ Platform in the plugin configuration file using the <code class="code " id="6e3f85fb_81"  >com.intellij.lang.foldingBuilder</code> extension point.</p><div class="code-block" data-lang="markup"         >
&lt;extensions defaultExtensionNs=&quot;com.intellij&quot;&gt;
  &lt;lang.foldingBuilder
      language=&quot;JAVA&quot;
      implementationClass=&quot;org.intellij.sdk.language.SimpleFoldingBuilder&quot;/&gt;
&lt;/extensions&gt;
</div></section><section class="chapter"  ><h2 id="run-the-project" data-toc="run-the-project"  >Run the Project</h2><p id="6e3f85fb_83" >Run the plugin by using the Gradle <a href="gradle-prerequisites.html#running-a-simple-gradle-based-intellij-platform-plugin" id="6e3f85fb_84" data-tooltip="Gradle projects are run from the IDE's Gradle Tool window."  ><code class="code " id="6e3f85fb_85"  >runIde</code></a> task.</p><p id="6e3f85fb_86" >Now when a Java file is opened in the editor, it shows the property's value instead of the key. This is because <code class="code " id="6e3f85fb_87"  >SimpleFoldingBuilder.isCollapsedByDefault()</code> always returns <code class="code " id="6e3f85fb_88"  >true</code>. Try using  to show the key rather than the value.</p><figure  id="6e3f85fb_90"><img alt="Folding" title="Folding" src="images/folding.png"  class="" width="800" height="342"/></figure></section><div class="last-modified"> Last modified: 29 九月 2022</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="find-usages-provider.html">11. Find Usages Provider</a>   <a class="navigation-links__next" href="go-to-symbol-contributor.html">13. Go To Symbol Contributor</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v5/app.js"></script></body></html>